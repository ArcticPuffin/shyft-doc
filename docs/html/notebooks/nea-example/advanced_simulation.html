<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Advanced simulation with Shyft &#8212; Shyft 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Shyft 0.1 documentation" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Shyft 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class^=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: #D84315;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Advanced-simulation-with-Shyft">
<h1>Advanced simulation with Shyft<a class="headerlink" href="#Advanced-simulation-with-Shyft" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>In <a class="reference internal" href="run_nea_nidelva.html"><span class="doc">Part I</span></a> of the simulation tutorials, we
covered conducting a very simple simulation of an example catchment
using configuration files. This is a typical use case, but assumes that
you have a model well configured and ready for simulation. In practice,
one is interested in working with the model, testing different
configurations, and evaluating different data sources.</p>
<p>This is in fact a key idea of Shyft &#8211; to make it simple to evaluate the
impact of the selection of model routine on the performance of the
simulation. In this notebook we walk through a lower level paradigm of
working with the toolbox and using the Shyft API directly to conduct the
simulations.</p>
<div class="section" id="This-notebook-is-guiding-through-the-simulation-process-of-a-catchment.-The-following-steps-are-described:">
<h3>This notebook is guiding through the simulation process of a catchment. The following steps are described:<a class="headerlink" href="#This-notebook-is-guiding-through-the-simulation-process-of-a-catchment.-The-following-steps-are-described:" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><strong>Loading required python modules and setting path to SHyFT
installation</strong></li>
<li><strong>Running of a Shyft simulation</strong></li>
<li><strong>Running a Shyft simulation with updated parameters</strong></li>
<li><strong>Activating the simulation only for selected catchments</strong></li>
<li><strong>Setting up different input datasets</strong></li>
<li><strong>Changing state collection settings</strong></li>
<li><strong>Post processing and extracting results</strong></li>
</ol>
</div>
</div>
<div class="section" id="Loading-the-required-modules-and-setting-the-environment">
<h2>Loading the required modules and setting the environment<a class="headerlink" href="#Loading-the-required-modules-and-setting-the-environment" title="Permalink to this headline">¶</a></h2>
<p>As before, we have to make sure our python environment is set up for
conducing simulations with Shyft and load the appropriate modules and
libraries.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Imports for data processing</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">datetime</span> <span class="kn">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">shyft_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;../../../shyft&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">shyft_path</span><span class="p">)</span>

<span class="c1"># Shyft imports</span>
<span class="kn">from</span> <span class="nn">shyft</span> <span class="kn">import</span> <span class="n">api</span>
<span class="kn">from</span> <span class="nn">shyft.orchestration.configuration.yaml_configs</span> <span class="kn">import</span> <span class="n">YAMLSimConfig</span>
<span class="kn">from</span> <span class="nn">shyft.orchestration.simulators.config_simulator</span> <span class="kn">import</span> <span class="n">ConfigSimulator</span>
<span class="c1"># 1.Setting up a simulator using configuration saved on file</span>
<span class="n">config_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;./nea-config/neanidelva_simulation.yaml&quot;</span><span class="p">)</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">YAMLSimConfig</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">,</span> <span class="s2">&quot;neanidelva&quot;</span><span class="p">)</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">ConfigSimulator</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Exploring-the-Shyft-API">
<h2>Exploring the Shyft API<a class="headerlink" href="#Exploring-the-Shyft-API" title="Permalink to this headline">¶</a></h2>
<p>In the following section we&#8217;ll explore several components of the
<code class="docutils literal"><span class="pre">shyft.api</span></code>. We consider the strength of Shyft to lie within this
Application Programming Interface, or API. To the uninitiated, it adds
quite a degree of complexity. However, once you understand the different
components and paradigms of Shyft, you&#8217;ll see the flexibility the API
offers provides a great number of possibilities for exploring hydrologic
simulations.</p>
<p>To start, as in the first tutorial, we&#8217;ll start with a <code class="docutils literal"><span class="pre">YAMLSimConfig</span></code>
object and create a <code class="docutils literal"><span class="pre">ConfigSimulator</span></code>. This will get us going quickly
and provide a <code class="docutils literal"><span class="pre">region_model</span></code> as a starting point. But in this
tutorial, the point is to work more closely with different components of
the <code class="docutils literal"><span class="pre">Shyft.api</span></code>. In particular, we hope to demonstrate how the
underlying <code class="docutils literal"><span class="pre">region_model</span></code>, rather than a <code class="docutils literal"><span class="pre">simulator</span></code>, is developed.
The latter is just a wrapper that is made for convenience when running
models operationally. If one is interested in working with Shyft to
explore algorithm performance, it is easier to work directly with the
<code class="docutils literal"><span class="pre">region_model</span></code> class.</p>
<p>The API approach will take a bit more code to get started, but will
allow great flexibility later on. The first thing we&#8217;ll do is to expose
several of the attributes (which are mostly Shyft API classes) of the
<code class="docutils literal"><span class="pre">simulator</span></code> object. Let&#8217;s begin by getting those in our namespace:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># expose attributes of the simulator</span>
<span class="n">region_model</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">region_model</span>
<span class="n">region_model_id</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">region_model_id</span>
<span class="n">interpolation_id</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">interpolation_id</span>
</pre></div>
</div>
</div>
<p>In the <a class="reference internal" href="run_nea_nidelva.html#The-simulator-and-the-region_model"><span class="std std-ref">first
tutorial</span></a>
we discussed the <code class="docutils literal"><span class="pre">region_model</span></code>. If you are unfamiliar with this
class, we recommend reviewing the <a class="reference external" href="region_model.rst">description</a>.</p>
<div class="section" id="The-concept-of-Shyft-repositories">
<h3>The concept of Shyft repositories<a class="headerlink" href="#The-concept-of-Shyft-repositories" title="Permalink to this headline">¶</a></h3>
<p>In Shyft, we consider that input data is a &#8220;source&#8221;. Our source data
resides in some kind of data serialization... be it a text file, netcdf
file, or database... One could have any kind of storage format for the
source data. <a class="reference external" href="repositories.rst">Repositories</a> are Python based
interfaces to data. Several have been created within Shyft already, but
users are encouraged to create their own. A guiding paradigm to Shyft is
that data should live as close to the source as possible (ideally, at
the source). The repositories connect to the data source and make the
data available to Shyft.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># expose the repositories</span>
<span class="n">region_model_repo</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">region_model_repository</span>
<span class="n">interpolation_param_repo</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">ip_repos</span>
<span class="n">geo_ts_repo</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">geo_ts_repository</span>
<span class="n">initial_state_repo</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">initial_state_repo</span>
</pre></div>
</div>
</div>
<p>Now we have exposed the <strong>repositories</strong> that we connected to our
<code class="docutils literal"><span class="pre">region_model</span></code> during configuration. Having access to the
repositories, means that we have access to the input data sources
directly (found in <code class="docutils literal"><span class="pre">geo_ts_repository</span></code>). We also have several other
repositories, including a repository for the interpolation parameters,
initial state, and the region_model. We&#8217;ll explore some of these a bit
deeper now. But first we&#8217;ll expose a few more pieces of information from
the region_model while we&#8217;re at it.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">epsg</span> <span class="o">=</span> <span class="n">region_model</span><span class="o">.</span><span class="n">bounding_region</span><span class="o">.</span><span class="n">epsg</span><span class="p">()</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="n">region_model</span><span class="o">.</span><span class="n">bounding_region</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">(</span><span class="n">epsg</span><span class="p">)</span>
<span class="n">period</span> <span class="o">=</span> <span class="n">region_model</span><span class="o">.</span><span class="n">time_axis</span><span class="o">.</span><span class="n">total_period</span><span class="p">()</span>
<span class="n">geo_ts_names</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;wind_speed&quot;</span><span class="p">,</span> <span class="s2">&quot;precipitation&quot;</span><span class="p">,</span> <span class="s2">&quot;relative_humidity&quot;</span><span class="p">,</span> <span class="s2">&quot;radiation&quot;</span><span class="p">)</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">geo_ts_repo</span><span class="o">.</span><span class="n">get_timeseries</span><span class="p">(</span><span class="n">geo_ts_names</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">geo_location_criteria</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal"><span class="pre">epsg</span></code> is simply the domain projection information for our
simulation. <code class="docutils literal"><span class="pre">bbox</span></code> provides the bounding box coordinates. <code class="docutils literal"><span class="pre">period</span></code>
gives the total period of the simulation. Lastly, we create a tuple of
the &#8216;geolocated timeseries names&#8217; or <code class="docutils literal"><span class="pre">geo_ts_names</span></code> as it is referred
to here. And use this to get the <em>sources</em> out of our repository. Note
that these names:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">temperature</span>
<span class="n">wind_speed</span>
<span class="n">precipitation</span>
<span class="n">relative_humidity</span>
<span class="n">radiation</span>
</pre></div>
</div>
<p>Are embedded into Shyft as timeseries names that are required for
simulations. In the current implementations, these are the default names
used in repositories and, at present, the only forcing data required. If
one were to develop new algorithms that reqiured other forcings, you
would need to define these in a custom repository. See <code class="docutils literal"><span class="pre">interfaces.py</span></code>
for more details.</p>
<p>Before going further, let&#8217;s look at what we have so far...</p>
<p>We won&#8217;t look in detail at all the repositories, but let&#8217;s take a look
at the <code class="docutils literal"><span class="pre">geo_ts_repo</span></code>:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># explore geo_ts_repo</span>
<span class="c1">#help(geo_ts_repo)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal"><span class="pre">geo_ts_repo</span></code> is a collection of geolocated timeseries
repositories. Note that <code class="docutils literal"><span class="pre">geo_ts_repo</span></code> has an attribute:
<code class="docutils literal"><span class="pre">.geo_ts_repositories</span></code>... this seems redundant? This is simply a list
of the repositories this class is &#8216;managing&#8217;.</p>
<p>Maybe we want to look at the precipitation input series in more detail.
We can get at those via this class. NOTE, this may not be the most
typical way to look at your input data (presumably you may have already
done this before the simulation working with the raw netcdf files), but
in case you wish to see the datasets from the &#8220;model&#8221; perspective, this
is how you gain access. Also, maybe you want to conduct a simulation,
then make a data correction. You could do that by accessing the values
here. Each of the aforementioned series types have a specialized source
vector type in Shyft. In the case of precipitation it is a
<code class="docutils literal"><span class="pre">api.PrecipitationSourceVector</span></code>. If we dig into this, we&#8217;ll find some
aspects familiar from the first tutorial.</p>
<p>Let&#8217;s get the precipitation timeseries out of the repository for the
period of the simulation first:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># above we already created a `sources` dictionary by</span>
<span class="c1"># using the `get_timeseries` method. This method takes a</span>
<span class="c1"># list of the timeseries names as input and a period</span>
<span class="c1"># of type &#39;shyft.api._api.UtcPeriod&#39;</span>
<span class="c1"># it returns a dictionary, keyed by the names of the timeseries</span>
<span class="n">prec</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;precipitation&#39;</span><span class="p">]</span>

<span class="c1"># `prec` is now a `api.PrecipitationSourceVector` and if you look</span>
<span class="c1"># you&#39;ll see it 10 elements:</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prec</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
10
</pre></div></div>
</div>
<p>We can explore further and see each element is in itself an
<code class="docutils literal"><span class="pre">api.PrecipitationSource</span></code>, which has a timeseries (ts). Recall from
the <a class="reference internal" href="run_nea_nidelva.html#Visualizing-the-discharge-for-each-[sub-]catchment"><span class="std std-ref">first
tutorial</span></a>
that we can easily convert the <code class="docutils literal"><span class="pre">timeseries.time_axis</span></code> into datetime
values for plotting.</p>
<p>Let&#8217;s plot the precip of each of the sources:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">prec</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="n">t_</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="k">for</span> <span class="n">t_</span> <span class="ow">in</span> <span class="n">pr</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">time_axis</span><span class="p">],</span> <span class="n">pr</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">values</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">mid_point</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="c1">#uid is empty now, but we reserve for later use</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Precipitation Input Sources&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;precip[mm/hr]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.text.Text at 0x7f40e91d8048&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="../../_images/notebooks_nea-example_advanced_simulation_15_1.png" src="../../_images/notebooks_nea-example_advanced_simulation_15_1.png" />
</div>
</div>
<p>Before we leave this section, we can also take a quick look at the
<code class="docutils literal"><span class="pre">interpolation_param_repo</span></code>. This is a different type of repository,
and it contains the parameters that will be passed to the interpolation
algorithm to take a point-source timeseries and interpolate them to the
Shyft cells, or in the context of of the API: <code class="docutils literal"><span class="pre">region_model.cells</span></code>.
We&#8217;ll quickly look at the <code class="docutils literal"><span class="pre">.params</span></code> attribute, which is a dictionary.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">interpolation_param_repo</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>{&#39;precipitation&#39;: {&#39;method&#39;: &#39;idw&#39;,
  &#39;params&#39;: {&#39;distance_measure_factor&#39;: 1.0,
   &#39;max_distance&#39;: 600000.0,
   &#39;max_members&#39;: 10,
   &#39;scale_factor&#39;: 1.02}},
 &#39;radiation&#39;: {&#39;method&#39;: &#39;idw&#39;,
  &#39;params&#39;: {&#39;distance_measure_factor&#39;: 1.0,
   &#39;max_distance&#39;: 600000.0,
   &#39;max_members&#39;: 10}},
 &#39;relative_humidity&#39;: {&#39;method&#39;: &#39;idw&#39;,
  &#39;params&#39;: {&#39;distance_measure_factor&#39;: 1.0,
   &#39;max_distance&#39;: 600000.0,
   &#39;max_members&#39;: 10}},
 &#39;temperature&#39;: {&#39;method&#39;: &#39;btk&#39;,
  &#39;params&#39;: {&#39;nug&#39;: 0.5,
   &#39;range&#39;: 200000.0,
   &#39;sill&#39;: 25.0,
   &#39;temperature_gradient&#39;: -0.6,
   &#39;temperature_gradient_sd&#39;: 0.25,
   &#39;zscale&#39;: 20.0}},
 &#39;wind_speed&#39;: {&#39;method&#39;: &#39;idw&#39;,
  &#39;params&#39;: {&#39;distance_measure_factor&#39;: 1.0,
   &#39;max_distance&#39;: 600000.0,
   &#39;max_members&#39;: 10}}}
</pre></div>
</div>
</div>
<p>One quickly recognizes the same input source type keywords that are used
as keys to the <code class="docutils literal"><span class="pre">params</span></code> dictionary. <code class="docutils literal"><span class="pre">params</span></code> is simply a dictionary
of dictionaries which contains the parameters used by the interpolation
model that is specific for each source type.</p>
<p>In closing, one is encouraged to understand well the concept of the
<strong>repositories</strong>. As a user of Shyft, it is likely you&#8217;ll want to create
your own repository to access your data directly rather than creating
input files for Shyft. Keep in mind that the repositories are Python
code, and not a part of the core C++ code of Shyft. They are designed to
provide an interface between the C++ code and potentially more
&#8216;pythonic&#8217; paradigms. In the following section, you&#8217;ll see that we
populate a C++ class from a repository collection.</p>
</div>
<div class="section" id="The-ARegionEnvironment-class">
<h3>The ARegionEnvironment class<a class="headerlink" href="#The-ARegionEnvironment-class" title="Permalink to this headline">¶</a></h3>
<p>The next thing we&#8217;ll do is to create an <code class="docutils literal"><span class="pre">api.ARegionEnvironment</span></code> class
to use in our custom simulation. As the <code class="docutils literal"><span class="pre">geo_ts_repo</span></code> was a Python
interface that provided a collection of all the timeseries repositories,
the <code class="docutils literal"><span class="pre">region_env</span></code> is an API type that provides a container of the
&#8220;sources&#8221; of data specific to the model. We will now create an
<code class="docutils literal"><span class="pre">api.ARegionEnvironment</span></code> from the <code class="docutils literal"><span class="pre">geo_ts_repo</span></code>. It may be helpful
to think of a <code class="docutils literal"><span class="pre">region_env</span></code> as the container of input data for the
<code class="docutils literal"><span class="pre">region_model</span></code> &#8211; in fact, that is what it is.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">get_region_env</span><span class="p">(</span><span class="n">sources_</span><span class="p">):</span>
    <span class="n">region_env_</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">ARegionEnvironment</span><span class="p">()</span>
    <span class="n">region_env_</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">sources_</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
    <span class="n">region_env_</span><span class="o">.</span><span class="n">precipitation</span> <span class="o">=</span> <span class="n">sources_</span><span class="p">[</span><span class="s2">&quot;precipitation&quot;</span><span class="p">]</span>
    <span class="n">region_env_</span><span class="o">.</span><span class="n">radiation</span> <span class="o">=</span> <span class="n">sources_</span><span class="p">[</span><span class="s2">&quot;radiation&quot;</span><span class="p">]</span>
    <span class="n">region_env_</span><span class="o">.</span><span class="n">wind_speed</span> <span class="o">=</span> <span class="n">sources_</span><span class="p">[</span><span class="s2">&quot;wind_speed&quot;</span><span class="p">]</span>
    <span class="n">region_env_</span><span class="o">.</span><span class="n">rel_hum</span> <span class="o">=</span> <span class="n">sources_</span><span class="p">[</span><span class="s2">&quot;relative_humidity&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">region_env_</span>

<span class="n">region_env</span> <span class="o">=</span> <span class="n">get_region_env</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>What we have done here is to convert our input data from the Python
based repositories into a C++ type object that is used in the Shyft
core. It may feel redundant to <code class="docutils literal"><span class="pre">geo_ts_repo</span></code>, but there are underlying
differences. Still, you&#8217;ll see that now the &#8216;sources&#8217; are direct
attributes of the <code class="docutils literal"><span class="pre">region_env</span></code> class:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_env</span><span class="o">.</span><span class="n">precipitation</span><span class="p">))</span>
<span class="nb">type</span><span class="p">(</span><span class="n">region_env</span><span class="o">.</span><span class="n">precipitation</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
10
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>shyft.api._api.PrecipitationSource
</pre></div>
</div>
</div>
</div>
<div class="section" id="Interpolation-Parameters">
<h3>Interpolation Parameters<a class="headerlink" href="#Interpolation-Parameters" title="Permalink to this headline">¶</a></h3>
<p>In the same manner that we need to convert the sources from the Python
based container, we&#8217;ll also create an API object from the
<code class="docutils literal"><span class="pre">interpolation_param_repo</span></code>.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">interpolation_parameters</span> <span class="o">=</span> <span class="n">interpolation_param_repo</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">interpolation_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Okay, now we are set to <em>rebuild</em> our <code class="docutils literal"><span class="pre">region_model</span></code> from scratch. In
the next few steps we&#8217;re going to walk through initialization of the
<code class="docutils literal"><span class="pre">region_model</span></code> to set it up for simulation.</p>
</div>
</div>
<div class="section" id="Initialization-of-the-region_model">
<h2>Initialization of the region_model<a class="headerlink" href="#Initialization-of-the-region_model" title="Permalink to this headline">¶</a></h2>
<p>The two <code class="docutils literal"><span class="pre">shyft.api</span></code> types: <code class="docutils literal"><span class="pre">api.ARegionEnvironment</span></code> and
<code class="docutils literal"><span class="pre">api.InterpolationParameter</span></code> together are used to initialize the
<code class="docutils literal"><span class="pre">region_model</span></code>. In the next step, all of the timeseries input sources
are interpolated to the geolocated model cells. After this step, each
cell is the model has it&#8217;s own <code class="docutils literal"><span class="pre">env_ts</span></code> which contains the timeseries
for that cell. Let&#8217;s first do the interpolation, the we can explore the
<code class="docutils literal"><span class="pre">region_model.cells</span></code> a bit further.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1">#region_model.run_interpolation(interpolation_parameters, region_model.time_axis, region_env)</span>
<span class="n">region_model</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">interpolation_parameters</span><span class="p">,</span> <span class="n">region_env</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Okay, that was simple. Let&#8217;s look at the timeseries in some individual
cells. The following is a bit of a contrived example, but it shows some
aspects of the api. We&#8217;ll plot the temperature series of all the cells
in one sub-catchment, and color them by elevation.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">matplotlib.cm</span> <span class="kn">import</span> <span class="n">jet</span> <span class="k">as</span> <span class="n">jet</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Normalize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1"># get all the cells for one sub-catchment with &#39;id&#39; == 1228</span>
<span class="n">c1228</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">region_model</span><span class="o">.</span><span class="n">cells</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">catchment_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1228</span><span class="p">]</span>

<span class="c1"># for plotting, create an mpl normalizer based on min,max elevation</span>
<span class="n">elv</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mid_point</span><span class="p">()</span><span class="o">.</span><span class="n">z</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c1228</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">elv</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">elv</span><span class="p">))</span>

<span class="c1">#plot with line color a function of elevation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># here we are cycling through each of the cells in c1228</span>
<span class="k">for</span> <span class="n">dat</span><span class="p">,</span><span class="n">elv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">env_ts</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c1228</span><span class="p">],</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">mid_point</span><span class="p">()</span><span class="o">.</span><span class="n">z</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c1228</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">jet</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">elv</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">elv</span><span class="p">))</span>


<span class="c1"># the following is just to plot the legend entries and not related to Shyft</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

<span class="c1"># sort by labels</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="n">hl</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">handles2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">hl</span><span class="p">)</span>

<span class="c1"># show legend, but only every fifth entry</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles2</span><span class="p">[::</span><span class="mi">5</span><span class="p">],</span> <span class="n">labels2</span><span class="p">[::</span><span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Elevation [m]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x7f40e492e5c0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="../../_images/notebooks_nea-example_advanced_simulation_29_1.png" src="../../_images/notebooks_nea-example_advanced_simulation_29_1.png" />
</div>
</div>
<p>As we would expect from the temperature kriging method, we should find
higher elevations have colder temperatures. As an exercise you could
explore this relationship using a scatter plot.</p>
<p>Now we&#8217;re going to create a function that will read initial states from
the <code class="docutils literal"><span class="pre">initial_state_repo</span></code>. In practice, this is already done by the
<code class="docutils literal"><span class="pre">ConfgiSimulator</span></code>, but to demonstrate lower level functions, we&#8217;ll
reset the states of our <code class="docutils literal"><span class="pre">region_model</span></code>:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># create a function to read the states from the state repository</span>
<span class="k">def</span> <span class="nf">get_init_state_from_repo</span><span class="p">(</span><span class="n">initial_state_repo_</span><span class="p">,</span> <span class="n">region_model_id_</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">state_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">initial_state_repo_</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">):</span>  <span class="c1"># No stored state, generated on-the-fly</span>
        <span class="n">initial_state_repo_</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">region_model</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">states</span> <span class="o">=</span> <span class="n">initial_state_repo_</span><span class="o">.</span><span class="n">find_state</span><span class="p">(</span>
            <span class="n">region_model_id_criteria</span><span class="o">=</span><span class="n">region_model_id_</span><span class="p">,</span>
            <span class="n">utc_timestamp_criteria</span><span class="o">=</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">state_id</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state_id</span>  <span class="c1"># most_recent_state i.e. &lt;= start time</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;No initial state matching criteria.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">initial_state_repo_</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="n">state_id</span><span class="p">)</span>

<span class="n">init_state</span> <span class="o">=</span> <span class="n">get_init_state_from_repo</span><span class="p">(</span><span class="n">initial_state_repo</span><span class="p">,</span> <span class="n">region_model_id_</span><span class="o">=</span><span class="n">region_model_id</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">region_model</span><span class="o">.</span><span class="n">time_axis</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>Don&#8217;t worry too much about the function for now, but do take note of the
<code class="docutils literal"><span class="pre">init_state</span></code> object that we created. This is another container, this
time it is a class that contains <code class="docutils literal"><span class="pre">PTGSKState</span></code> objects, which are
specific to the model stack implemented in the simulation (in this case
<code class="docutils literal"><span class="pre">PTGSK</span></code>). If we explore an individual state object, we&#8217;ll see
<code class="docutils literal"><span class="pre">init_state</span></code> contains, for each cell in our simulation, the state
variables for each &#8216;method&#8217; of the method stack.</p>
<p>Let&#8217;s look more closely:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">print_pub_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="c1">#only public attributes</span>
    <span class="k">print</span><span class="p">([</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">if</span> <span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;_&#39;</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">init_state</span><span class="p">))</span>
<span class="n">init_state_cell0</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># gam snow states</span>
<span class="n">print_pub_attr</span><span class="p">(</span><span class="n">init_state_cell0</span><span class="o">.</span><span class="n">gs</span><span class="p">)</span>

<span class="c1">#init_state_cell0.kirchner states</span>
<span class="n">print_pub_attr</span><span class="p">(</span><span class="n">init_state_cell0</span><span class="o">.</span><span class="n">kirchner</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
4650
[&#39;acc_melt&#39;, &#39;albedo&#39;, &#39;alpha&#39;, &#39;iso_pot_energy&#39;, &#39;lwc&#39;, &#39;sdc_melt_mean&#39;, &#39;surface_heat&#39;, &#39;temp_swe&#39;]
[&#39;q&#39;]
</pre></div></div>
</div>
<div class="section" id="Summary">
<h3>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h3>
<p>We have now explored the <code class="docutils literal"><span class="pre">region_model</span></code> and looked at how to
instantiate a <code class="docutils literal"><span class="pre">region_model</span></code> by using a <code class="docutils literal"><span class="pre">api.ARegionEnvironment</span></code>,
containing a collection of timeseries sources, and passing an
<code class="docutils literal"><span class="pre">api.InterpolationParameter</span></code> class containing the parameters to use
for the data interpolation algorithms. The interpolation step
&#8220;populated&#8221; our cells with data from the point sources.</p>
<p>The cells each contain all the information related to the simulation
(their own timeseries, <code class="docutils literal"><span class="pre">env_ts</span></code>; their own model parameters,
<code class="docutils literal"><span class="pre">parameter</span></code>; and other attributes and methods). In future tutorials
we&#8217;ll work with the cells indivdual &#8220;resource collector&#8221; (<code class="docutils literal"><span class="pre">.rc</span></code>) and
&#8220;state collector&#8221; (<code class="docutils literal"><span class="pre">.sc</span></code>) attributes.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Advanced simulation with Shyft</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a><ul>
<li><a class="reference internal" href="#This-notebook-is-guiding-through-the-simulation-process-of-a-catchment.-The-following-steps-are-described:">This notebook is guiding through the simulation process of a catchment. The following steps are described:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Loading-the-required-modules-and-setting-the-environment">Loading the required modules and setting the environment</a></li>
<li><a class="reference internal" href="#Exploring-the-Shyft-API">Exploring the Shyft API</a><ul>
<li><a class="reference internal" href="#The-concept-of-Shyft-repositories">The concept of Shyft repositories</a></li>
<li><a class="reference internal" href="#The-ARegionEnvironment-class">The ARegionEnvironment class</a></li>
<li><a class="reference internal" href="#Interpolation-Parameters">Interpolation Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Initialization-of-the-region_model">Initialization of the region_model</a><ul>
<li><a class="reference internal" href="#Summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/notebooks/nea-example/advanced_simulation.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Shyft 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Sigbjørn Helset, Ola Skavhaug, John F. Burkhart.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>