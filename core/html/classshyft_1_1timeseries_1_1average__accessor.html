<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SHyFT: shyft::timeseries::average_accessor&lt; S, TA &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SHyFT
   &#160;<span id="projectnumber">master</span>
   </div>
   <div id="projectbrief">SHyFT</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classshyft_1_1timeseries_1_1average__accessor.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classshyft_1_1timeseries_1_1average__accessor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">shyft::timeseries::average_accessor&lt; S, TA &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html" title="average_accessor provides a projection/interpretation of the values of a point source on to a time-ax...">average_accessor</a> provides a projection/interpretation of the values of a point source on to a time-axis as provided with semantics as needed/practical for this project.  
 <a href="classshyft_1_1timeseries_1_1average__accessor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af0cffec63463d41d76ffba7998d9fd35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#af0cffec63463d41d76ffba7998d9fd35">average_accessor</a> (const S &amp;source, const TA &amp;time_axis)</td></tr>
<tr class="separator:af0cffec63463d41d76ffba7998d9fd35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6319c3f66e7eba8a86c7c061b8abb0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#a2e6319c3f66e7eba8a86c7c061b8abb0">average_accessor</a> (std::shared_ptr&lt; S &gt; source, const TA &amp;time_axis)</td></tr>
<tr class="separator:a2e6319c3f66e7eba8a86c7c061b8abb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad671f8e0c6d12e4ec8cafcbf061671e1"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#ad671f8e0c6d12e4ec8cafcbf061671e1">get_last_index</a> () const</td></tr>
<tr class="separator:ad671f8e0c6d12e4ec8cafcbf061671e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2405bd25cc7e169f7d2b5e7f705350"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#a0e2405bd25cc7e169f7d2b5e7f705350">value</a> (const size_t i) const</td></tr>
<tr class="separator:a0e2405bd25cc7e169f7d2b5e7f705350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a308367054d24ffef65d6743115007077"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#a308367054d24ffef65d6743115007077">size</a> () const</td></tr>
<tr class="separator:a308367054d24ffef65d6743115007077"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class S, class TA&gt;<br />
class shyft::timeseries::average_accessor&lt; S, TA &gt;</h3>

<p><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html" title="average_accessor provides a projection/interpretation of the values of a point source on to a time-ax...">average_accessor</a> provides a projection/interpretation of the values of a point source on to a time-axis as provided with semantics as needed/practical for this project. </p>
<p>This includes interpolation and true average, </p><dl class="section note"><dt>Note</dt><dd>point interpretation: We try to interpret the points as f(t), using either stair-case (start of step) or linear between points interpretations.</dd>
<dd>
stair-case is ideal for timeseries where each period on the timeaxis contains a value that represents the average value for that timestep. E.g. average discharge, precipitation etc.</dd>
<dd>
linear-between points is ideal/better when the time-value points represents an instantaneous value, observed at(or around) that particular timepoints and where the signal is assumed to follow 'natural' changes. eg. temperature: observed 12 degC at 8am, 16 degC at 10am, then a linear approximation is used to calculate f(t) in that interval</dd>
<dd>
nan-handling semantics: when a nan point is introduced at to, then f(t) is Nan from that point until next non-nan point.</dd>
<dd>
Computation of true average true-average = 1/(t1-t0) * integral (t0..t1) f(t) dt</dd></dl>
<p>Only non-nan parts of the time-axis contributes to the area, integrated time distance. e.g.: if half the interval have nan values, and remaining is 10.0, then true average is 10.0 (not 5.0).</p>
<p>TODO: maybe this approach fits for some cases, but not all? Then introduce parameters to get what we want ?</p>
<p>In addition the accessor allows fast sequential access to these values using clever caching of the last position used in the underlying point source. The time axis and point source can be of any type as listed above as long as the basic type requirement as described below are satisfied. This is typically the case for observed time-series point sources, where values could be missing, bad, or just irregularly sampled.</p>
<dl class="section note"><dt>Note</dt><dd>Notice that the S and T objects are const referenced and not owned by Accessor, the intention is that accessor is low-cost/light-weight class, to be created and used in tight(closed) local (thread)scopes. The variables it wrapped should have a lifetime longer than accessor. TODO: consider to leave the lifetime-stuff to the user, by spec types..</dd></dl>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">S</td><td>point source, must provide:<ol type="1">
<li>.<a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#a308367054d24ffef65d6743115007077">size() const </a> -&gt; number of points in the source</li>
<li>.index_of(utctime tx) const -&gt; return lower bound index or -1 for the supplied tx</li>
<li>.get(size_t i) const  -&gt; return the i'th point (t,v)</li>
<li>.point_fx const -&gt; point_interpretation(POINT_INSTANT_VALUE|POINT_AVERAGE_VALUE) </li>
</ol>
</td></tr>
    <tr><td class="paramname">TA</td><td>time axis, must provide:<ol type="1">
<li>operator()(size_t i) const &ndash;&gt; return the i'th period of timeaxis</li>
<li></li>
</ol>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Accessor that provides:<ol type="1">
<li><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html#a0e2405bd25cc7e169f7d2b5e7f705350">value(size_t i) const </a>-&gt; double, the value at the i'th interval of the supplied time-axis </li>
</ol>
</dd></dl>

<p>Definition at line <a class="el" href="core_2timeseries_8h_source.html#l01047">1047</a> of file <a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af0cffec63463d41d76ffba7998d9fd35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0cffec63463d41d76ffba7998d9fd35">&sect;&nbsp;</a></span>average_accessor() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class S, class TA&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">shyft::timeseries::average_accessor</a>&lt; S, TA &gt;::<a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">average_accessor</a> </td>
          <td>(</td>
          <td class="paramtype">const S &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TA &amp;&#160;</td>
          <td class="paramname"><em>time_axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="core_2timeseries_8h_source.html#l01057">1057</a> of file <a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>.</p>

</div>
</div>
<a id="a2e6319c3f66e7eba8a86c7c061b8abb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e6319c3f66e7eba8a86c7c061b8abb0">&sect;&nbsp;</a></span>average_accessor() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class S, class TA&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">shyft::timeseries::average_accessor</a>&lt; S, TA &gt;::<a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">average_accessor</a> </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; S &gt;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TA &amp;&#160;</td>
          <td class="paramname"><em>time_axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="core_2timeseries_8h_source.html#l01059">1059</a> of file <a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad671f8e0c6d12e4ec8cafcbf061671e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad671f8e0c6d12e4ec8cafcbf061671e1">&sect;&nbsp;</a></span>get_last_index()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class S, class TA&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">shyft::timeseries::average_accessor</a>&lt; S, TA &gt;::get_last_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="core_2timeseries_8h_source.html#l01062">1062</a> of file <a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>.</p>

</div>
</div>
<a id="a308367054d24ffef65d6743115007077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a308367054d24ffef65d6743115007077">&sect;&nbsp;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class S, class TA&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">shyft::timeseries::average_accessor</a>&lt; S, TA &gt;::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="core_2timeseries_8h_source.html#l01071">1071</a> of file <a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classshyft_1_1timeseries_1_1average__accessor_a308367054d24ffef65d6743115007077_icgraph.png" border="0" usemap="#classshyft_1_1timeseries_1_1average__accessor_a308367054d24ffef65d6743115007077_icgraph" alt=""/></div>
<map name="classshyft_1_1timeseries_1_1average__accessor_a308367054d24ffef65d6743115007077_icgraph" id="classshyft_1_1timeseries_1_1average__accessor_a308367054d24ffef65d6743115007077_icgraph">
<area shape="rect" id="node2" href="structshyft_1_1core_1_1model__calibration_1_1ts__transform.html#a227bf627cd34db1751e68dd60edfa49b" title="transform the supplied time&#45;series, f(t) interpreted according to its point_interpretation() policy i..." alt="" coords="213,5,383,61"/>
</map>
</div>

</div>
</div>
<a id="a0e2405bd25cc7e169f7d2b5e7f705350"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e2405bd25cc7e169f7d2b5e7f705350">&sect;&nbsp;</a></span>value()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class S, class TA&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">shyft::timeseries::average_accessor</a>&lt; S, TA &gt;::value </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="core_2timeseries_8h_source.html#l01064">1064</a> of file <a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_cgraph.png" border="0" usemap="#classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_cgraph" alt=""/></div>
<map name="classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_cgraph" id="classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_cgraph">
<area shape="rect" id="node2" href="namespaceshyft_1_1timeseries.html#a0d651da5f6e3bc99dabe237a36c6e66c" title="average_value provides a projection/interpretation of the values of a pointsource on to a time&#45;axis a..." alt="" coords="220,89,347,131"/>
<area shape="rect" id="node3" href="namespaceshyft_1_1timeseries.html#a388c165bea7597e2fd0264fe272c5479" title="accumulate_value provides a projection/interpretation of the values of a pointsource on to a time&#45;axi..." alt="" coords="395,89,521,131"/>
<area shape="rect" id="node4" href="namespaceshyft_1_1timeseries.html#a0ae2034e3c41545804ad8afac947c2ba" title="hint_based search to eliminate binary&#45;search in irregular time&#45;point series. " alt="" coords="580,5,711,47"/>
<area shape="rect" id="node5" href="namespaceshyft_1_1timeseries.html#a4fa091ae89d99e00daff8f0821576893" title="shyft::timeseries::min" alt="" coords="769,42,917,69"/>
<area shape="rect" id="node6" href="namespaceshyft_1_1timeseries.html#ac53ac01de119a07afeaf67d32cd151e7" title="shyft::timeseries::max" alt="" coords="569,122,721,149"/>
<area shape="rect" id="node7" href="structshyft_1_1core_1_1utcperiod.html#a657dbfcddcc6ea03d1db9c2248320bdb" title="shyft::core::utcperiod\l::timespan" alt="" coords="573,173,718,215"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_icgraph.png" border="0" usemap="#classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_icgraph" alt=""/></div>
<map name="classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_icgraph" id="classshyft_1_1timeseries_1_1average__accessor_a0e2405bd25cc7e169f7d2b5e7f705350_icgraph">
<area shape="rect" id="node2" href="structshyft_1_1core_1_1kalman_1_1bias__predictor.html#a2964e0d74b45e32273878329a79b324f" title="shyft::core::kalman\l::bias_predictor::update\l_with_forecast" alt="" coords="225,5,384,61"/>
<area shape="rect" id="node3" href="structshyft_1_1core_1_1model__calibration_1_1ts__transform.html#a227bf627cd34db1751e68dd60edfa49b" title="transform the supplied time&#45;series, f(t) interpreted according to its point_interpretation() policy i..." alt="" coords="220,85,389,141"/>
</map>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/sih/projects/shyft/core/<a class="el" href="core_2timeseries_8h_source.html">timeseries.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceshyft.html">shyft</a></li><li class="navelem"><a class="el" href="namespaceshyft_1_1timeseries.html">timeseries</a></li><li class="navelem"><a class="el" href="classshyft_1_1timeseries_1_1average__accessor.html">average_accessor</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
