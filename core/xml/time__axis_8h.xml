<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="time__axis_8h" kind="file" language="C++">
    <compoundname>time_axis.h</compoundname>
    <includes local="no">exception</includes>
    <includes local="no">string</includes>
    <includes local="no">memory</includes>
    <includes local="no">algorithm</includes>
    <includes refid="utctime__utilities_8h" local="yes">utctime_utilities.h</includes>
    <includedby refid="core_2timeseries_8h" local="yes">/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/timeseries.h</includedby>
    <includedby refid="api_8h" local="yes">/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/api.h</includedby>
    <includedby refid="api_2timeseries_8h" local="yes">/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/timeseries.h</includedby>
    <incdepgraph>
      <node id="1283">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/time_axis.h</label>
        <link refid="time__axis_8h"/>
        <childnode refid="1284" relation="include">
        </childnode>
        <childnode refid="1285" relation="include">
        </childnode>
        <childnode refid="1286" relation="include">
        </childnode>
        <childnode refid="1287" relation="include">
        </childnode>
        <childnode refid="1288" relation="include">
        </childnode>
      </node>
      <node id="1288">
        <label>utctime_utilities.h</label>
        <link refid="utctime__utilities_8h"/>
        <childnode refid="1285" relation="include">
        </childnode>
        <childnode refid="1289" relation="include">
        </childnode>
        <childnode refid="1290" relation="include">
        </childnode>
        <childnode refid="1291" relation="include">
        </childnode>
        <childnode refid="1292" relation="include">
        </childnode>
        <childnode refid="1286" relation="include">
        </childnode>
      </node>
      <node id="1290">
        <label>cmath</label>
      </node>
      <node id="1285">
        <label>string</label>
      </node>
      <node id="1292">
        <label>map</label>
      </node>
      <node id="1284">
        <label>exception</label>
      </node>
      <node id="1291">
        <label>vector</label>
      </node>
      <node id="1289">
        <label>time.h</label>
      </node>
      <node id="1287">
        <label>algorithm</label>
      </node>
      <node id="1286">
        <label>memory</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1293">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/time_axis.h</label>
        <link refid="time__axis_8h"/>
        <childnode refid="1294" relation="include">
        </childnode>
        <childnode refid="1300" relation="include">
        </childnode>
        <childnode refid="1316" relation="include">
        </childnode>
      </node>
      <node id="1302">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/cell_model.h</label>
        <link refid="cell__model_8h"/>
        <childnode refid="1303" relation="include">
        </childnode>
        <childnode refid="1304" relation="include">
        </childnode>
        <childnode refid="1299" relation="include">
        </childnode>
        <childnode refid="1305" relation="include">
        </childnode>
        <childnode refid="1306" relation="include">
        </childnode>
      </node>
      <node id="1313">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/pt_ss_k.h</label>
        <link refid="api_2pt__ss__k_8h"/>
      </node>
      <node id="1295">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/bayesian_kriging.h</label>
        <link refid="bayesian__kriging_8h"/>
        <childnode refid="1296" relation="include">
        </childnode>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1312">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/pt_ss_k.h</label>
        <link refid="core_2pt__ss__k_8h"/>
        <childnode refid="1306" relation="include">
        </childnode>
        <childnode refid="1313" relation="include">
        </childnode>
      </node>
      <node id="1303">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/pt_gs_k_cell_model.h</label>
        <link refid="pt__gs__k__cell__model_8h"/>
        <childnode refid="1297" relation="include">
        </childnode>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1294">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/timeseries.h</label>
        <link refid="core_2timeseries_8h"/>
        <childnode refid="1295" relation="include">
        </childnode>
        <childnode refid="1302" relation="include">
        </childnode>
        <childnode refid="1297" relation="include">
        </childnode>
        <childnode refid="1307" relation="include">
        </childnode>
        <childnode refid="1314" relation="include">
        </childnode>
        <childnode refid="1315" relation="include">
        </childnode>
        <childnode refid="1300" relation="include">
        </childnode>
        <childnode refid="1316" relation="include">
        </childnode>
      </node>
      <node id="1299">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/model_calibration.h</label>
        <link refid="model__calibration_8h"/>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1308">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/pt_gs_k.h</label>
        <link refid="core_2pt__gs__k_8h"/>
        <childnode refid="1296" relation="include">
        </childnode>
        <childnode refid="1303" relation="include">
        </childnode>
        <childnode refid="1309" relation="include">
        </childnode>
      </node>
      <node id="1307">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/kirchner.h</label>
        <link refid="kirchner_8h"/>
        <childnode refid="1296" relation="include">
        </childnode>
        <childnode refid="1308" relation="include">
        </childnode>
        <childnode refid="1310" relation="include">
        </childnode>
        <childnode refid="1312" relation="include">
        </childnode>
      </node>
      <node id="1300">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/api.h</label>
        <link refid="api_8h"/>
        <childnode refid="1301" relation="include">
        </childnode>
      </node>
      <node id="1304">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/hbv_stack_cell_model.h</label>
        <link refid="hbv__stack__cell__model_8h"/>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1314">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/gamma_snow.h</label>
        <link refid="gamma__snow_8h"/>
        <childnode refid="1296" relation="include">
        </childnode>
        <childnode refid="1308" relation="include">
        </childnode>
      </node>
      <node id="1305">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/pt_hs_k_cell_model.h</label>
        <link refid="pt__hs__k__cell__model_8h"/>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1316">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/timeseries.h</label>
        <link refid="api_2timeseries_8h"/>
        <childnode refid="1300" relation="include">
        </childnode>
        <childnode refid="1317" relation="include">
        </childnode>
      </node>
      <node id="1296">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/region_model.h</label>
        <link refid="region__model_8h"/>
        <childnode refid="1297" relation="include">
        </childnode>
        <childnode refid="1299" relation="include">
        </childnode>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1310">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/pt_hs_k.h</label>
        <link refid="core_2pt__hs__k_8h"/>
        <childnode refid="1296" relation="include">
        </childnode>
        <childnode refid="1305" relation="include">
        </childnode>
        <childnode refid="1311" relation="include">
        </childnode>
      </node>
      <node id="1309">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/pt_gs_k.h</label>
        <link refid="api_2pt__gs__k_8h"/>
      </node>
      <node id="1298">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/experimental.cpp</label>
        <link refid="experimental_8cpp"/>
      </node>
      <node id="1297">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/experimental.h</label>
        <link refid="experimental_8h"/>
        <childnode refid="1298" relation="include">
        </childnode>
      </node>
      <node id="1306">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/pt_ss_k_cell_model.h</label>
        <link refid="pt__ss__k__cell__model_8h"/>
        <childnode refid="1300" relation="include">
        </childnode>
      </node>
      <node id="1317">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/timeseries.cpp</label>
        <link refid="timeseries_8cpp"/>
      </node>
      <node id="1315">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/skaugen.h</label>
        <link refid="skaugen_8h"/>
        <childnode refid="1312" relation="include">
        </childnode>
      </node>
      <node id="1301">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/api.cpp</label>
        <link refid="api_8cpp"/>
      </node>
      <node id="1311">
        <label>/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/api/pt_hs_k.h</label>
        <link refid="api_2pt__hs__k_8h"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structshyft_1_1time__axis_1_1continuous" prot="public">shyft::time_axis::continuous</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1continuous_3_01true_01_4" prot="public">shyft::time_axis::continuous&lt; true &gt;</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1fixed__dt" prot="public">shyft::time_axis::fixed_dt</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1calendar__dt" prot="public">shyft::time_axis::calendar_dt</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1point__dt" prot="public">shyft::time_axis::point_dt</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1generic__dt" prot="public">shyft::time_axis::generic_dt</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1calendar__dt__p" prot="public">shyft::time_axis::calendar_dt_p</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1period__list" prot="public">shyft::time_axis::period_list</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1combine__type" prot="public">shyft::time_axis::combine_type</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1combine__type_3_01fixed__dt_00_01fixed__dt_00_01void_01_4" prot="public">shyft::time_axis::combine_type&lt; fixed_dt, fixed_dt, void &gt;</innerclass>
    <innerclass refid="structshyft_1_1time__axis_1_1combine__type_3_01_t___a_00_01_t___b_00_01typename_01enable__if_3_086a4fbcb431e554b079aed359898683b" prot="public">shyft::time_axis::combine_type&lt; T_A, T_B, typename enable_if&lt; T_A::continuous::value &amp;&amp;T_B::continuous::value &gt;::type &gt;</innerclass>
    <innernamespace refid="namespaceshyft">shyft</innernamespace>
    <innernamespace refid="namespaceshyft_1_1time__axis">shyft::time_axis</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#pragma<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;exception&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;memory&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;algorithm&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="utctime__utilities_8h" kindref="compound">utctime_utilities.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceshyft" kindref="compound">shyft</ref><sp/>{</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="24" refid="namespaceshyft_1_1time__axis" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">time_axis<sp/>{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespacestd" kindref="compound">std</ref>;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceshyft_1_1core" kindref="compound">shyft::core</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="34" refid="structshyft_1_1time__axis_1_1continuous" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref><sp/>{</highlight></codeline>
<codeline lineno="35" refid="structshyft_1_1time__axis_1_1continuous_1aeced14fe4486961b16feba5282e38a16" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>value<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;&gt;</highlight></codeline>
<codeline lineno="38" refid="structshyft_1_1time__axis_1_1continuous_3_01true_01_4" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;true&gt;<sp/>{</highlight></codeline>
<codeline lineno="39" refid="structshyft_1_1time__axis_1_1continuous_3_01true_01_4_1ad44db8ccec4b1b8cd1a9dc72d6fc485d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>value<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="47" refid="structshyft_1_1time__axis_1_1fixed__dt" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>:<sp/><ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;true&gt;<sp/>{</highlight></codeline>
<codeline lineno="48" refid="structshyft_1_1time__axis_1_1fixed__dt_1a6f1cb94f567f87b65c07413441a76ef0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a6f1cb94f567f87b65c07413441a76ef0" kindref="member">t</ref>;</highlight></codeline>
<codeline lineno="49" refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref>;</highlight></codeline>
<codeline lineno="50" refid="structshyft_1_1time__axis_1_1fixed__dt_1a5d6811761e7f9c06f8bb5e8ce0bd7924" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5d6811761e7f9c06f8bb5e8ce0bd7924" kindref="member">n</ref>;</highlight></codeline>
<codeline lineno="51" refid="structshyft_1_1time__axis_1_1fixed__dt_1a40f3640b76aa640e283e5357417d2396" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a40f3640b76aa640e283e5357417d2396" kindref="member">fixed_dt</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>start=<ref refid="namespaceshyft_1_1core_1a9e2c2bed860603f73a29f2eb89c167e5" kindref="member">no_utctime</ref>,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>deltat=0,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n_periods=0<sp/>)<sp/>:<sp/>t(<sp/>start<sp/>),<sp/>dt(<sp/>deltat<sp/>),<sp/>n(<sp/>n_periods<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="52" refid="structshyft_1_1time__axis_1_1fixed__dt_1ac06d98b47fc2ce141c3c30cc2f424de6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1ac06d98b47fc2ce141c3c30cc2f424de6" kindref="member">delta</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dt;}</highlight><highlight class="comment">//BW<sp/>compat</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="structshyft_1_1time__axis_1_1fixed__dt_1a282ebc1f311a915e7ab60aaa2f92d0b5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a282ebc1f311a915e7ab60aaa2f92d0b5" kindref="member">start</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>t;}<sp/></highlight><highlight class="comment">//BW<sp/>compat</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="structshyft_1_1time__axis_1_1fixed__dt_1a61dc811a635c77b3c06ad262aefb9d52" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a61dc811a635c77b3c06ad262aefb9d52" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n;}</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="structshyft_1_1time__axis_1_1fixed__dt_1a5be8dd4e8ba1bd488a64350e94682b99" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5be8dd4e8ba1bd488a64350e94682b99" kindref="member">total_period</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n<sp/>==<sp/>0<sp/>?</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref>,<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref><sp/>)<sp/>:<sp/><sp/></highlight><highlight class="comment">//<sp/>maybe<sp/>just<sp/>a<sp/>non-valid<sp/>period?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>t,<sp/>t<sp/>+<sp/>n<sp/>*<sp/>dt<sp/>);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="structshyft_1_1time__axis_1_1fixed__dt_1a83621ead26eafb2f70ee6a5e45dcf733" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a83621ead26eafb2f70ee6a5e45dcf733" kindref="member">time</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>n<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>t<sp/>+<sp/>i<sp/>*<sp/>dt;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;fixed_dt.time(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="structshyft_1_1time__axis_1_1fixed__dt_1ae2dd5a143af9cee16a38e7625f7aa5ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1ae2dd5a143af9cee16a38e7625f7aa5ce" kindref="member">period</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>n<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>t<sp/>+<sp/>i<sp/>*<sp/>dt,<sp/>t<sp/>+<sp/>(<sp/>i<sp/>+<sp/>1<sp/>)<sp/>*<sp/>dt<sp/>);</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;fixed_dt.period(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72" refid="structshyft_1_1time__axis_1_1fixed__dt_1a6a4715a004b6e6d54eb7b7694aa9fe6e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a6a4715a004b6e6d54eb7b7694aa9fe6e" kindref="member">index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>tx<sp/>&lt;<sp/>t<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::string::npos;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>r<sp/>=<sp/>(<sp/>tx<sp/>-<sp/>t<sp/>)<sp/>/<sp/>dt;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>r<sp/>&lt;<sp/>n<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::string::npos;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="78" refid="structshyft_1_1time__axis_1_1fixed__dt_1a3003ac961caeb4620b4a8cd0c4551637" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a3003ac961caeb4620b4a8cd0c4551637" kindref="member">open_range_index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>(<sp/>tx<sp/>&gt;=<sp/>t<sp/>+<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref>(<sp/>n<sp/>*<sp/>dt<sp/>)<sp/>)<sp/>?<sp/>n<sp/>-<sp/>1<sp/>:<sp/>index_of(<sp/>tx<sp/>);}</highlight></codeline>
<codeline lineno="79" refid="structshyft_1_1time__axis_1_1fixed__dt_1a967470fed776d7c449c1357e7e5b939c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a967470fed776d7c449c1357e7e5b939c" kindref="member">full_range</ref>()<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>(<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref>,<sp/><ref refid="namespaceshyft_1_1core_1a9c6ef8d0f6928169d82fae882e927900" kindref="member">max_utctime</ref>,<sp/>2<sp/>);}<sp/><sp/></highlight><highlight class="comment">//Hmm.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="structshyft_1_1time__axis_1_1fixed__dt_1ac4fc01ee49df2734371212df1fb5d7ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1ac4fc01ee49df2734371212df1fb5d7ca" kindref="member">null_range</ref>()<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>(<sp/>0,<sp/>0,<sp/>0<sp/>);}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="structshyft_1_1time__axis_1_1calendar__dt" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/>:<ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;true&gt;<sp/>{</highlight></codeline>
<codeline lineno="88" refid="structshyft_1_1time__axis_1_1calendar__dt_1afc7b65d41f2dc466dc1db26932609fbb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt_h<sp/>=<sp/>3600;</highlight></codeline>
<codeline lineno="89" refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>shared_ptr&lt;const<sp/>calendar&gt;<sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" kindref="member">cal</ref>;</highlight></codeline>
<codeline lineno="90" refid="structshyft_1_1time__axis_1_1calendar__dt_1a46174b8b5e42ddbcc512542fd40715b1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a46174b8b5e42ddbcc512542fd40715b1" kindref="member">t</ref>;</highlight></codeline>
<codeline lineno="91" refid="structshyft_1_1time__axis_1_1calendar__dt_1a0e365b95213429239680006e4043f591" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a0e365b95213429239680006e4043f591" kindref="member">dt</ref>;</highlight></codeline>
<codeline lineno="92" refid="structshyft_1_1time__axis_1_1calendar__dt_1acad03a9d9bc46fead736dde5b572fa4a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1acad03a9d9bc46fead736dde5b572fa4a" kindref="member">n</ref>;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94" refid="structshyft_1_1time__axis_1_1calendar__dt_1a2d32620077677ee28c480b56a9347bd3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a2d32620077677ee28c480b56a9347bd3" kindref="member">calendar_dt</ref>()<sp/>:<sp/>t(<sp/><ref refid="namespaceshyft_1_1core_1a9e2c2bed860603f73a29f2eb89c167e5" kindref="member">no_utctime</ref><sp/>),<sp/>dt(<sp/>0<sp/>),<sp/>n(<sp/>0<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="95" refid="structshyft_1_1time__axis_1_1calendar__dt_1ad36e598f7057e21173e99a66645469d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad36e598f7057e21173e99a66645469d6" kindref="member">calendar_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>shared_ptr&lt;const<sp/>calendar&gt;&amp;<sp/>cal,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n<sp/>)<sp/>:<sp/>cal(<sp/>cal<sp/>),<sp/>t(<sp/>t<sp/>),<sp/>dt(<sp/>dt<sp/>),<sp/>n(<sp/>n<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="96" refid="structshyft_1_1time__axis_1_1calendar__dt_1a10cab7f88e6dadad8b6c019be28a6659" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a10cab7f88e6dadad8b6c019be28a6659" kindref="member">calendar_dt</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref>&amp;c):cal(c.cal),t(c.t),dt(c.dt),n(c.n)<sp/>{}</highlight></codeline>
<codeline lineno="97" refid="structshyft_1_1time__axis_1_1calendar__dt_1a738b5fd195c469da96bc382604db97ef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a738b5fd195c469da96bc382604db97ef" kindref="member">calendar_dt</ref>(<ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/>&amp;&amp;c):cal(<ref refid="namespacestd" kindref="compound">std</ref>::move(c.cal)),t(c.t),dt(c.dt),n(c.n){}</highlight></codeline>
<codeline lineno="98" refid="structshyft_1_1time__axis_1_1calendar__dt_1abca16e7a234f87c968940b718690b154" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref>&amp;<sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1abca16e7a234f87c968940b718690b154" kindref="member">operator=</ref>(<ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref>&amp;&amp;c)<sp/>{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cal=std::move(c.cal);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=c.t;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dt=c.dt;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=c.n;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105" refid="structshyft_1_1time__axis_1_1calendar__dt_1aaab393e3bcb86ca96f0e7b4968d52f02" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref>&amp;<sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1aaab393e3bcb86ca96f0e7b4968d52f02" kindref="member">operator=</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/>&amp;x)<sp/>{</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(</highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>!=<sp/>&amp;x)<sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cal=x.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" kindref="member">cal</ref>;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=x.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a46174b8b5e42ddbcc512542fd40715b1" kindref="member">t</ref>;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dt=x.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a0e365b95213429239680006e4043f591" kindref="member">dt</ref>;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=x.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1acad03a9d9bc46fead736dde5b572fa4a" kindref="member">n</ref>;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="structshyft_1_1time__axis_1_1calendar__dt_1a1de3356137fe218e0eddd1b0a077a403" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a1de3356137fe218e0eddd1b0a077a403" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n;}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117" refid="structshyft_1_1time__axis_1_1calendar__dt_1ad3d3e95846ad74b7937e81ebcb4e2e25" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad3d3e95846ad74b7937e81ebcb4e2e25" kindref="member">total_period</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n<sp/>==<sp/>0<sp/>?</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref>,<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref><sp/>)<sp/>:<sp/><sp/></highlight><highlight class="comment">//<sp/>maybe<sp/>just<sp/>a<sp/>non-valid<sp/>period?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>t,<sp/>dt<sp/>&lt;=<sp/>dt_h<sp/>?<sp/>t<sp/>+<sp/>n*dt<sp/>:<sp/>cal-&gt;add(<sp/>t,<sp/>dt,</highlight><highlight class="keywordtype">long</highlight><highlight class="normal">(n)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123" refid="structshyft_1_1time__axis_1_1calendar__dt_1ad8826e61949f9ac97ab658b316e498ea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad8826e61949f9ac97ab658b316e498ea" kindref="member">time</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>n<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dt<sp/>&lt;=<sp/>dt_h<sp/>?<sp/>t<sp/>+<sp/>i<sp/>*<sp/>dt<sp/>:<sp/>cal-&gt;add(<sp/>t,<sp/>dt,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal">(i)<sp/>);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;calendar_dt.time(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128" refid="structshyft_1_1time__axis_1_1calendar__dt_1a0192a7c857cc99bc7e151691d6a87351" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a0192a7c857cc99bc7e151691d6a87351" kindref="member">period</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>n<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dt<sp/>&lt;=<sp/>dt_h<sp/>?<sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>t<sp/>+<sp/>i<sp/>*<sp/>dt,<sp/>t<sp/>+<sp/>(<sp/>i<sp/>+<sp/>1<sp/>)<sp/>*<sp/>dt<sp/>)<sp/>:<sp/>utcperiod(<sp/>cal-&gt;add(<sp/>t,<sp/>dt,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal">(<sp/>i)<sp/>),<sp/>cal-&gt;add(<sp/>t,<sp/>dt,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal">(i<sp/>+<sp/>1)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;calendar_dt.period(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133" refid="structshyft_1_1time__axis_1_1calendar__dt_1abc4bfd2fa592c4ad609040ee5e150a62" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1abc4bfd2fa592c4ad609040ee5e150a62" kindref="member">index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>total_period();</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!p.contains(<sp/>tx<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string::npos;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dt<sp/>&lt;=<sp/>dt_h<sp/>?</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<sp/>size_t<sp/>)(<sp/>(<sp/>tx<sp/>-<sp/>t<sp/>)<sp/>/<sp/>dt<sp/>)<sp/>:</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>)<sp/>cal-&gt;diff_units(<sp/>t,<sp/>tx,<sp/>dt<sp/>);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141" refid="structshyft_1_1time__axis_1_1calendar__dt_1aaa708de89632ff5d904e806682dcf4b4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt_1aaa708de89632ff5d904e806682dcf4b4" kindref="member">open_range_index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tx<sp/>&gt;=<sp/>total_period().end<sp/>&amp;&amp;<sp/>n<sp/>&gt;<sp/>0<sp/>?<sp/>n<sp/>-<sp/>1<sp/>:<sp/>index_of(<sp/>tx<sp/>);}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="160" refid="structshyft_1_1time__axis_1_1point__dt" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref>:<ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;true&gt;{</highlight></codeline>
<codeline lineno="161" refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vector&lt;utctime&gt;<sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>;</highlight></codeline>
<codeline lineno="162" refid="structshyft_1_1time__axis_1_1point__dt_1ab72d26e05117a10ed2f6fe5946e295dc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1ab72d26e05117a10ed2f6fe5946e295dc" kindref="member">t_end</ref>;</highlight><highlight class="comment">//<sp/>need<sp/>one<sp/>extra,<sp/>after<sp/>t.back(),<sp/>to<sp/>give<sp/>the<sp/>last<sp/>period!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="structshyft_1_1time__axis_1_1point__dt_1a9dfd766e6bbd8f2f31d5060dafa9d2a7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a9dfd766e6bbd8f2f31d5060dafa9d2a7" kindref="member">point_dt</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="164" refid="structshyft_1_1time__axis_1_1point__dt_1a0f440dd32ad80b5a847425c6c60e9886" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a0f440dd32ad80b5a847425c6c60e9886" kindref="member">point_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>vector&lt;utctime&gt;&amp;<sp/>t,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t_end<sp/>)<sp/>:<sp/>t(<sp/>t<sp/>),<sp/>t_end(<sp/>t_end<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO:<sp/>throw<sp/>if<sp/>t.back()&gt;=<sp/>t_end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>consider<sp/>t_end==no_utctime<sp/>,<sp/>t_end=t.back()+tick.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t.size()==0<sp/>||<sp/>t.back()&gt;=t_end<sp/>)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>runtime_error(</highlight><highlight class="stringliteral">&quot;time_axis::point_dt()<sp/>illegal<sp/>initialization<sp/>parameters&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="170" refid="structshyft_1_1time__axis_1_1point__dt_1a4d6e0251216033d9af1adaaf67f95abb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a4d6e0251216033d9af1adaaf67f95abb" kindref="member">point_dt</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>vector&lt;utctime&gt;&amp;<sp/>all_points):t(all_points){</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t.size()&lt;2)</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>runtime_error(</highlight><highlight class="stringliteral">&quot;time_axis::point_dt()<sp/>needs<sp/>at<sp/>least<sp/>two<sp/>time-points&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t_end<sp/>=<sp/>t.back();</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t.pop_back();</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="177" refid="structshyft_1_1time__axis_1_1point__dt_1ae44fe4c240738ae6db4062c83f5c9fd3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1ae44fe4c240738ae6db4062c83f5c9fd3" kindref="member">point_dt</ref>(vector&lt;utctime&gt;<sp/>&amp;&amp;<sp/>all_points):t(move(all_points))<sp/>{</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(t.size()<sp/>&lt;<sp/>2)</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>runtime_error(</highlight><highlight class="stringliteral">&quot;time_axis::point_dt()<sp/>needs<sp/>at<sp/>least<sp/>two<sp/>time-points&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t_end<sp/>=<sp/>t.back();</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t.pop_back();</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184" refid="structshyft_1_1time__axis_1_1point__dt_1ad752e45244aa1bf07b1037f8fee4b1ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1ad752e45244aa1bf07b1037f8fee4b1ed" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>t.size();}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186" refid="structshyft_1_1time__axis_1_1point__dt_1a4f25c366205653bbc9af34b038a0a5c6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a4f25c366205653bbc9af34b038a0a5c6" kindref="member">total_period</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>t.size()<sp/>==<sp/>0<sp/>?</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref>,<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref><sp/>)<sp/>:<sp/><sp/></highlight><highlight class="comment">//<sp/>maybe<sp/>just<sp/>a<sp/>non-valid<sp/>period?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>t[0],<sp/>t_end<sp/>);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192" refid="structshyft_1_1time__axis_1_1point__dt_1a328d5aa9f9ec30f54166979edee02632" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a328d5aa9f9ec30f54166979edee02632" kindref="member">time</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>t.size()<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>t[i];</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;point_dt.time(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197" refid="structshyft_1_1time__axis_1_1point__dt_1a9e83ca04a372384a2ae0e2f479d394fc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a9e83ca04a372384a2ae0e2f479d394fc" kindref="member">period</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>t.size()<sp/>)<sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>t[i],<sp/>i<sp/>+<sp/>1<sp/>&lt;<sp/>t.size()<sp/>?<sp/>t[i<sp/>+<sp/>1]<sp/>:<sp/>t_end<sp/>);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;point_dt.period(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202" refid="structshyft_1_1time__axis_1_1point__dt_1afe2595c2754c007d0df419faf66848d3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1afe2595c2754c007d0df419faf66848d3" kindref="member">index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ix_hint<sp/>=<sp/>std::string::npos<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t.size()<sp/>==<sp/>0<sp/>||<sp/>tx<sp/>&lt;<sp/>t[0]<sp/>||<sp/>tx<sp/>&gt;=<sp/>t_end<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::string::npos;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>tx<sp/>&gt;=<sp/>t.back()<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>t.size()<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ix_hint<sp/>!=<sp/>std::string::npos<sp/>&amp;&amp;<sp/>ix_hint<sp/>&lt;<sp/>t.size()<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t[ix_hint]<sp/>==<sp/>tx<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>max_directional_search<sp/>=<sp/>10;<sp/></highlight><highlight class="comment">//<sp/>just<sp/><sp/>a<sp/>wild<sp/>guess</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t[ix_hint]<sp/>&lt;<sp/>tx<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>t[ix_hint]<sp/>&lt;<sp/>tx<sp/>&amp;&amp;<sp/>++j<sp/>&lt;<sp/>max_directional_search<sp/>&amp;&amp;<sp/>ix_hint<sp/>&lt;<sp/>t.size()<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix_hint++;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t[ix_hint]<sp/>&gt;=<sp/>tx<sp/>||<sp/>ix_hint<sp/>==<sp/>t.size()<sp/>)<sp/><sp/></highlight><highlight class="comment">//<sp/>we<sp/>startet<sp/>below<sp/>p.start,<sp/>so<sp/>we<sp/>got<sp/>one<sp/>to<sp/>far(or<sp/>at<sp/>end),<sp/>so<sp/>revert<sp/>back<sp/>one<sp/>step</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>give<sp/>up<sp/>and<sp/>fall<sp/>through<sp/>to<sp/>binary-search</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>t[ix_hint]<sp/>&gt;<sp/>tx<sp/>&amp;&amp;<sp/>++j<sp/>&lt;<sp/>max_directional_search<sp/>&amp;&amp;<sp/>ix_hint<sp/>&gt;<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--ix_hint;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t[ix_hint]<sp/>&gt;<sp/>tx<sp/>&amp;&amp;<sp/>ix_hint<sp/>&gt;<sp/>0<sp/>)<sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>we<sp/>are<sp/>still<sp/>not<sp/>before<sp/>p.start,<sp/>and<sp/>i<sp/>is<sp/>&gt;0,<sp/>there<sp/>is<sp/>a<sp/>hope<sp/>to<sp/>find<sp/>better<sp/>index,<sp/>otherwise<sp/>we<sp/>are<sp/>at/before<sp/>start</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/></highlight><highlight class="comment">//<sp/>bad<sp/>luck<sp/>searching<sp/>downward,<sp/>need<sp/>to<sp/>use<sp/>binary<sp/>search.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>r<sp/>=<sp/>lower_bound(<sp/>t.cbegin(),<sp/>t.cend(),<sp/>tx,[](<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>pt,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>val<sp/>)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pt<sp/>&lt;=<sp/>val;<sp/>}<sp/>);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">size_t</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<sp/>r<sp/>-<sp/>t.cbegin()<sp/>)<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232" refid="structshyft_1_1time__axis_1_1point__dt_1aec35e4bfdae5510f2448c746365f9ae7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1aec35e4bfdae5510f2448c746365f9ae7" kindref="member">open_range_index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>size()<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>tx<sp/>&gt;=<sp/>t_end<sp/>?<sp/>size()<sp/>-<sp/>1<sp/>:<sp/>index_of(<sp/>tx<sp/>);}</highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight></codeline>
<codeline lineno="234" refid="structshyft_1_1time__axis_1_1point__dt_1a87dcf53e93aba68d4adc4739c944c94e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a87dcf53e93aba68d4adc4739c944c94e" kindref="member">null_range</ref>()<sp/>{</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref>{};</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="247" refid="structshyft_1_1time__axis_1_1generic__dt" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>:<ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;true&gt;<sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//--possible<sp/>implementation<sp/>types:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249" refid="structshyft_1_1time__axis_1_1generic__dt_1aa1a23adcc42110c65455fd38bcb9b847a9c726d3eee925568c78c7e921c6daee2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1aa1a23adcc42110c65455fd38bcb9b847" kindref="member">generic_type</ref><sp/>{<sp/>FIXED<sp/>=<sp/>0,<sp/>CALENDAR<sp/>=<sp/>1,<sp/>POINT<sp/>=<sp/>2};</highlight></codeline>
<codeline lineno="250" refid="structshyft_1_1time__axis_1_1generic__dt_1a17577dd7618447b6d6fd2461d7c6f607" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1aa1a23adcc42110c65455fd38bcb9b847" kindref="member">generic_type</ref><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a17577dd7618447b6d6fd2461d7c6f607" kindref="member">gt</ref>;</highlight></codeline>
<codeline lineno="251" refid="structshyft_1_1time__axis_1_1generic__dt_1a0ab750b050f15fdad6c020f7480e6a9c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a0ab750b050f15fdad6c020f7480e6a9c" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="252" refid="structshyft_1_1time__axis_1_1generic__dt_1ada40bf65d34824815d4f79779d9484a2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1ada40bf65d34824815d4f79779d9484a2" kindref="member">c</ref>;</highlight></codeline>
<codeline lineno="253" refid="structshyft_1_1time__axis_1_1generic__dt_1ac7095df7ac641eafff68d31de1d32885" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1ac7095df7ac641eafff68d31de1d32885" kindref="member">p</ref>;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//---------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255" refid="structshyft_1_1time__axis_1_1generic__dt_1ab4207f39c0600a010bdda514edaa0ef8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1ab4207f39c0600a010bdda514edaa0ef8" kindref="member">generic_dt</ref>():<sp/>gt(<sp/>FIXED<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>provide<sp/>convinience<sp/>constructors,<sp/>to<sp/>directly<sp/>create<sp/>the<sp/>wanted<sp/>time-axis,<sp/>regardless<sp/>underlying<sp/>rep.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257" refid="structshyft_1_1time__axis_1_1generic__dt_1a6d69aa928e86a79a19e1dbaff16d4362" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a6d69aa928e86a79a19e1dbaff16d4362" kindref="member">generic_dt</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0,<ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt,</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n):gt(FIXED),f(t0,dt,n)<sp/>{}</highlight></codeline>
<codeline lineno="258" refid="structshyft_1_1time__axis_1_1generic__dt_1afdede32692bc9837bbe74befc871275b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1afdede32692bc9837bbe74befc871275b" kindref="member">generic_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>shared_ptr&lt;const<sp/>calendar&gt;&amp;<sp/>cal,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n<sp/>)<sp/>:<sp/>gt(CALENDAR),c(cal,t,dt,n)<sp/>{}</highlight></codeline>
<codeline lineno="259" refid="structshyft_1_1time__axis_1_1generic__dt_1a6cc8326b5fd52dc26605a03b2141e465" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a6cc8326b5fd52dc26605a03b2141e465" kindref="member">generic_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>vector&lt;utctime&gt;&amp;<sp/>t,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t_end<sp/>):gt(POINT),p(t,t_end)<sp/>{}</highlight></codeline>
<codeline lineno="260" refid="structshyft_1_1time__axis_1_1generic__dt_1a92b5b22f70e7f6d9fa16572c9ced4cbb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a92b5b22f70e7f6d9fa16572c9ced4cbb" kindref="member">generic_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>vector&lt;utctime&gt;&amp;<sp/>all_points):gt(POINT),p(all_points){}</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262" refid="structshyft_1_1time__axis_1_1generic__dt_1a0d97eab337873a7cd08a957a5dd31840" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a0d97eab337873a7cd08a957a5dd31840" kindref="member">generic_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>&amp;f<sp/>):<sp/>gt(<sp/>FIXED<sp/>),<sp/>f(<sp/>f<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="263" refid="structshyft_1_1time__axis_1_1generic__dt_1a63e7ae7b71c92f946fd4e422244be3fa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a63e7ae7b71c92f946fd4e422244be3fa" kindref="member">generic_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/>&amp;c<sp/>):<sp/>gt(<sp/>CALENDAR<sp/>),<sp/>c(<sp/>c<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="264" refid="structshyft_1_1time__axis_1_1generic__dt_1abf5c72b14d30ae43889839c8e5d9f2e9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1abf5c72b14d30ae43889839c8e5d9f2e9" kindref="member">generic_dt</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref>&amp;<sp/>p<sp/>):<sp/>gt(<sp/>POINT<sp/>),<sp/>p(<sp/>p<sp/>)<sp/>{}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266" refid="structshyft_1_1time__axis_1_1generic__dt_1a327730aec00459da3ff4852b17754582" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a327730aec00459da3ff4852b17754582" kindref="member">is_fixed_dt</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>gt<sp/>!=<sp/>POINT;}</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268" refid="structshyft_1_1time__axis_1_1generic__dt_1a4cadc695ec50189c8af79bfa59e51959" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a4cadc695ec50189c8af79bfa59e51959" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>gt<sp/>)<sp/>{</highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FIXED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a61dc811a635c77b3c06ad262aefb9d52" kindref="member">size</ref>();<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>CALENDAR:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a1de3356137fe218e0eddd1b0a077a403" kindref="member">size</ref>();<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>POINT:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.<ref refid="structshyft_1_1time__axis_1_1point__dt_1ad752e45244aa1bf07b1037f8fee4b1ed" kindref="member">size</ref>();}}</highlight></codeline>
<codeline lineno="269" refid="structshyft_1_1time__axis_1_1generic__dt_1a1ea9fa2294e8e84d7b15ee357f9cd6a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1a1ea9fa2294e8e84d7b15ee357f9cd6a1" kindref="member">total_period</ref>()</highlight><highlight class="keyword"><sp/>const<sp/><sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>gt<sp/>)<sp/>{</highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FIXED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5be8dd4e8ba1bd488a64350e94682b99" kindref="member">total_period</ref>();<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>CALENDAR:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad3d3e95846ad74b7937e81ebcb4e2e25" kindref="member">total_period</ref>();<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>POINT:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a4f25c366205653bbc9af34b038a0a5c6" kindref="member">total_period</ref>();}}</highlight></codeline>
<codeline lineno="270" refid="structshyft_1_1time__axis_1_1generic__dt_1ae0e1733df752984b8d8ecf8f3e067ed9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1ae0e1733df752984b8d8ecf8f3e067ed9" kindref="member">period</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>gt<sp/>)<sp/>{</highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FIXED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1ae2dd5a143af9cee16a38e7625f7aa5ce" kindref="member">period</ref>(<sp/>i<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>CALENDAR:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a0192a7c857cc99bc7e151691d6a87351" kindref="member">period</ref>(<sp/>i<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>POINT:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a9e83ca04a372384a2ae0e2f479d394fc" kindref="member">period</ref>(<sp/>i<sp/>);}}</highlight></codeline>
<codeline lineno="271" refid="structshyft_1_1time__axis_1_1generic__dt_1adddff7047229765d6713930000695bf0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1adddff7047229765d6713930000695bf0" kindref="member">time</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>gt<sp/>)<sp/>{</highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FIXED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a83621ead26eafb2f70ee6a5e45dcf733" kindref="member">time</ref>(<sp/>i<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>CALENDAR:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad8826e61949f9ac97ab658b316e498ea" kindref="member">time</ref>(<sp/>i<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>POINT:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a328d5aa9f9ec30f54166979edee02632" kindref="member">time</ref>(<sp/>i<sp/>);}}</highlight></codeline>
<codeline lineno="272" refid="structshyft_1_1time__axis_1_1generic__dt_1acf0137e33285de32abd2ddf791c2b77d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1acf0137e33285de32abd2ddf791c2b77d" kindref="member">index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>gt<sp/>)<sp/>{</highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FIXED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a6a4715a004b6e6d54eb7b7694aa9fe6e" kindref="member">index_of</ref>(<sp/>t<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>CALENDAR:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1abc4bfd2fa592c4ad609040ee5e150a62" kindref="member">index_of</ref>(<sp/>t<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>POINT:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.<ref refid="structshyft_1_1time__axis_1_1point__dt_1afe2595c2754c007d0df419faf66848d3" kindref="member">index_of</ref>(<sp/>t<sp/>);}}</highlight></codeline>
<codeline lineno="273" refid="structshyft_1_1time__axis_1_1generic__dt_1ae9d063cfe89dc2bd6c53c0e620ad3c23" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt_1ae9d063cfe89dc2bd6c53c0e620ad3c23" kindref="member">open_range_index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>gt<sp/>)<sp/>{</highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FIXED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a3003ac961caeb4620b4a8cd0c4551637" kindref="member">open_range_index_of</ref>(<sp/>t<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>CALENDAR:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1aaa708de89632ff5d904e806682dcf4b4" kindref="member">open_range_index_of</ref>(<sp/>t<sp/>);<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>POINT:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.<ref refid="structshyft_1_1time__axis_1_1point__dt_1aec35e4bfdae5510f2448c746365f9ae7" kindref="member">open_range_index_of</ref>(<sp/>t<sp/>);}}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="278" refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/>&amp;src,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt)<sp/>{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>(src.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a6f1cb94f567f87b65c07413441a76ef0" kindref="member">t</ref>+dt,src.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref>,src.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5d6811761e7f9c06f8bb5e8ce0bd7924" kindref="member">n</ref>);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="283" refid="namespaceshyft_1_1time__axis_1a3ba8d90d911007c2f32f253f4e50fe9e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref>&amp;<sp/>src,<ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/>r(src);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a46174b8b5e42ddbcc512542fd40715b1" kindref="member">t</ref>+=dt;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="290" refid="namespaceshyft_1_1time__axis_1a728ebc47d20fc77027b9a7bef121666c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref>&amp;<sp/>src,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt)<sp/>{</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref><sp/>r(src);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keyword">auto</highlight><highlight class="normal">&amp;<sp/>t:<sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>)<sp/>t+=dt;<sp/></highlight><highlight class="comment">//<sp/>potential<sp/>cost,<sp/>we<sp/>could<sp/>consider<sp/>other<sp/>approaches<sp/>with<sp/>refs..</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1ab72d26e05117a10ed2f6fe5946e295dc" kindref="member">t_end</ref>+=dt;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="298" refid="namespaceshyft_1_1time__axis_1a2e71ba3a5b359ee9ea0c4b161c10c66f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>&amp;src,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt)<sp/>{</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(src.<ref refid="structshyft_1_1time__axis_1_1generic__dt_1a17577dd7618447b6d6fd2461d7c6f607" kindref="member">gt</ref>==<ref refid="structshyft_1_1time__axis_1_1generic__dt_1aa1a23adcc42110c65455fd38bcb9b847ac92ad68cc8f3b7d83e47603b9041cfd6" kindref="member">generic_dt::FIXED</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>(<ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(src.<ref refid="structshyft_1_1time__axis_1_1generic__dt_1a0ab750b050f15fdad6c020f7480e6a9c" kindref="member">f</ref>,dt));</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(src.<ref refid="structshyft_1_1time__axis_1_1generic__dt_1a17577dd7618447b6d6fd2461d7c6f607" kindref="member">gt</ref>==<ref refid="structshyft_1_1time__axis_1_1generic__dt_1aa1a23adcc42110c65455fd38bcb9b847a9ea471df9dc624716a233b10298c2c73" kindref="member">generic_dt::CALENDAR</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>(<ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(src.<ref refid="structshyft_1_1time__axis_1_1generic__dt_1ada40bf65d34824815d4f79779d9484a2" kindref="member">c</ref>,dt));</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>(<ref refid="namespaceshyft_1_1time__axis_1af1741c22a839ac2d2b1faceed82c75cf" kindref="member">time_shift</ref>(src.<ref refid="structshyft_1_1time__axis_1_1generic__dt_1ac7095df7ac641eafff68d31de1d32885" kindref="member">p</ref>,dt));</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="314" refid="structshyft_1_1time__axis_1_1calendar__dt__p" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref>:<ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;false&gt;<sp/>{</highlight></codeline>
<codeline lineno="315" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1afb73481c7629fc7d5700d900e3640b94" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt" kindref="compound">calendar_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1afb73481c7629fc7d5700d900e3640b94" kindref="member">cta</ref>;</highlight></codeline>
<codeline lineno="316" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a2688117dbc8338b2e47ba2220210423f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vector&lt;utcperiod&gt;<sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a2688117dbc8338b2e47ba2220210423f" kindref="member">p</ref>;</highlight><highlight class="comment">//<sp/>sub-periods<sp/>within<sp/>each<sp/>cta.period,<sp/>using<sp/>cta.period.start<sp/>as<sp/>t0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a6a3ba0a69387d9b02c2d1a15c3da539d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a6a3ba0a69387d9b02c2d1a15c3da539d" kindref="member">calendar_dt_p</ref>(){}</highlight></codeline>
<codeline lineno="318" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1aac80812a737130ccaf325b1a9d956bf9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1aac80812a737130ccaf325b1a9d956bf9" kindref="member">calendar_dt_p</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>shared_ptr&lt;const<sp/>calendar&gt;&amp;<sp/>cal,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t,<sp/><ref refid="namespaceshyft_1_1core_1a560b7b3b8bf6190f749284f5fadd7271" kindref="member">utctimespan</ref><sp/>dt,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n,<sp/>vector&lt;utcperiod&gt;<sp/>p<sp/>)</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>cta(<sp/>cal,<sp/>t,<sp/>dt,<sp/>n<sp/>),<sp/>p(<sp/>move(<sp/>p<sp/>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>validate<sp/>p,<sp/>each<sp/>p[i]<sp/>non-overlapping<sp/>and<sp/>within<sp/>~<sp/>dt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>possibly<sp/>throw<sp/>if<sp/>invalid<sp/>period,<sp/>but</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>could<sp/>be<sp/>tricky,<sp/>because<sp/>the<sp/>&apos;gross<sp/>period&apos;<sp/>will<sp/>vary<sp/>over<sp/>the<sp/>timeaxis,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>so<sp/>worst<sp/>case<sp/>we<sp/>would<sp/>have<sp/>to<sp/>run<sp/>through<sp/>all<sp/>gross-periods<sp/>and<sp/>verify<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sub-periods<sp/>fits-within<sp/>each<sp/>gross<sp/>period.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="327" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a66fa26f4bdb12cd49763571663461ed8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a66fa26f4bdb12cd49763571663461ed8" kindref="member">calendar_dt_p</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref>&amp;c):cta(c.cta),p(c.p)<sp/>{}</highlight></codeline>
<codeline lineno="328" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a508bc578d6c7ad946169a01238d6d862" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a508bc578d6c7ad946169a01238d6d862" kindref="member">calendar_dt_p</ref>(<ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref><sp/>&amp;&amp;c):cta(<ref refid="namespacestd" kindref="compound">std</ref>::move(c.cta)),p(<ref refid="namespacestd" kindref="compound">std</ref>::move(c.p)){}</highlight></codeline>
<codeline lineno="329" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a847e96945017002b7708f4b321cb9650" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref>&amp;<sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a847e96945017002b7708f4b321cb9650" kindref="member">operator=</ref>(<ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref>&amp;&amp;c)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cta=std::move(c.cta);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p=std::move(c.p);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="334" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1ae384d8518b07006a91c95609a45018d3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref>&amp;<sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1ae384d8518b07006a91c95609a45018d3" kindref="member">operator=</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p" kindref="compound">calendar_dt_p</ref><sp/>&amp;x)<sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(</highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>!=<sp/>&amp;x)<sp/>{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cta=x.<ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1afb73481c7629fc7d5700d900e3640b94" kindref="member">cta</ref>;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p=x.<ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a2688117dbc8338b2e47ba2220210423f" kindref="member">p</ref>;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a35244e215f4dc5181aadf5fec4871edd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a35244e215f4dc5181aadf5fec4871edd" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a1de3356137fe218e0eddd1b0a077a403" kindref="member">size</ref>()<sp/>*<sp/>(<sp/>p.size()<sp/>?<sp/>p.size()<sp/>:<sp/>1<sp/>);}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a727a9c7f173243b97a1f14e497248ee4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a727a9c7f173243b97a1f14e497248ee4" kindref="member">total_period</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p.size()<sp/>==<sp/>0<sp/>||<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a1de3356137fe218e0eddd1b0a077a403" kindref="member">size</ref>()<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad3d3e95846ad74b7937e81ebcb4e2e25" kindref="member">total_period</ref>();</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>period(<sp/>0<sp/>).start,<sp/>period(<sp/>size()<sp/>-<sp/>1<sp/>).end<sp/>);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight></codeline>
<codeline lineno="350" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a454cfb5e006272737cf1a5a66e791e2e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a454cfb5e006272737cf1a5a66e791e2e" kindref="member">time</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>period(<sp/>i<sp/>).start;}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1af7f1041ec37026093ba159c997111ae2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1af7f1041ec37026093ba159c997111ae2" kindref="member">period</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>size()<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>main_ix<sp/>=<sp/>i<sp/>/<sp/>p.size();</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>p_ix<sp/>=<sp/>i<sp/>-<sp/>main_ix<sp/>*<sp/>p.size();</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>pi<sp/>=<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a0192a7c857cc99bc7e151691d6a87351" kindref="member">period</ref>(<sp/>main_ix<sp/>);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.size()<sp/>?</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" kindref="member">cal</ref>-&gt;add(<sp/>pi.start,<sp/>p[p_ix].start,<sp/>1<sp/>),<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" kindref="member">cal</ref>-&gt;add(<sp/>pi.start,<sp/>p[p_ix].end,<sp/>1<sp/>)<sp/>)<sp/>:</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pi;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;calendar_dt_p.period(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a137828f4d9a467fe06b07ee9e975d1c0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1a137828f4d9a467fe06b07ee9e975d1c0" kindref="member">index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>period_containment<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal"><sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>tp<sp/>=<sp/>total_period();</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!tp.contains(<sp/>tx<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string::npos;</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>main_ix<sp/>=<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1abc4bfd2fa592c4ad609040ee5e150a62" kindref="member">index_of</ref>(<sp/>tx<sp/>);</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p.size()<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>main_ix;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0<sp/>=<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1ad8826e61949f9ac97ab658b316e498ea" kindref="member">time</ref>(<sp/>main_ix<sp/>);</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>p.size();<sp/>++i<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//important:<sp/>p<sp/>is<sp/>assumed<sp/>to<sp/>have<sp/>size<sp/>like<sp/>5,<sp/>7<sp/>(workdays<sp/>etc).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pi(<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" kindref="member">cal</ref>-&gt;add(<sp/>t0,<sp/>p[i].start,<sp/>1<sp/>),<sp/>cta.<ref refid="structshyft_1_1time__axis_1_1calendar__dt_1a702301b60bb66b1d920a8eb59ad2179f" kindref="member">cal</ref>-&gt;add(<sp/>t0,<sp/>p[i].end,<sp/>1<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pi.contains(<sp/>tx<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.size()<sp/>*<sp/>main_ix<sp/>+<sp/>i;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!period_containment<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>just<sp/>searching<sp/>for<sp/>the<sp/>closest<sp/>period<sp/>back<sp/>in<sp/>time,<sp/>then:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pi.start<sp/>&gt;<sp/>tx<sp/>)<sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>previous<sp/>period<sp/>is<sp/>before<sp/>tx,<sp/>then<sp/>we<sp/>know<sp/>we<sp/>have<sp/>a<sp/>hit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.size()<sp/>*<sp/>main_ix<sp/>+<sp/>(<sp/>i<sp/>&gt;<sp/>0<sp/>||<sp/>main_ix<sp/>&gt;<sp/>0<sp/>?<sp/>i<sp/>-<sp/>1<sp/>:<sp/>0<sp/>);<sp/></highlight><highlight class="comment">//<sp/>it<sp/>might<sp/>be<sp/>a<sp/>hit<sp/>just<sp/>before<sp/>first<sp/>sub-period<sp/>as<sp/>well.<sp/>Kind<sp/>of<sp/>special<sp/>case(not<sp/>consistent,but<sp/>useful)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>+<sp/>1<sp/>==<sp/>p.size()<sp/>)<sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>current<sp/>period<sp/>is<sp/>the<sp/>last<sp/>one,<sp/>then<sp/>we<sp/>also<sp/>know<sp/>we<sp/>have<sp/>a<sp/>hit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.size()<sp/>*<sp/>main_ix<sp/>+<sp/>i;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string::npos;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="388" refid="structshyft_1_1time__axis_1_1calendar__dt__p_1aaec77605e0b44aeaa824a9c02cba08d4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1calendar__dt__p_1aaec77605e0b44aeaa824a9c02cba08d4" kindref="member">open_range_index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>size()<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>tx<sp/>&gt;=<sp/>total_period().end<sp/>?<sp/>size()<sp/>-<sp/>1<sp/>:<sp/>index_of(<sp/>tx,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="401" refid="structshyft_1_1time__axis_1_1period__list" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref>:<ref refid="structshyft_1_1time__axis_1_1continuous" kindref="compound">continuous</ref>&lt;false&gt;{</highlight></codeline>
<codeline lineno="402" refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vector&lt;utcperiod&gt;<sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>;</highlight></codeline>
<codeline lineno="403" refid="structshyft_1_1time__axis_1_1period__list_1a6fbb26245efed3684e3d14630485018f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a6fbb26245efed3684e3d14630485018f" kindref="member">period_list</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="404" refid="structshyft_1_1time__axis_1_1period__list_1a3f7217b7491276846aa05c4aa0106845" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a3f7217b7491276846aa05c4aa0106845" kindref="member">period_list</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>vector&lt;utcperiod&gt;&amp;<sp/>p<sp/>)<sp/>:<sp/>p(<sp/>p<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO:<sp/>high<sp/>cost,<sp/>consider<sp/>doing<sp/>this<sp/>in<sp/>DEBUG<sp/>only!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i=1;i&lt;p.size();++i)<sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(p[i].start&lt;p[i-1].end)</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>runtime_error(</highlight><highlight class="stringliteral">&quot;period_list:periods<sp/>should<sp/>be<sp/>ordered<sp/>and<sp/>non-overlapping&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>TA&gt;</highlight></codeline>
<codeline lineno="412" refid="structshyft_1_1time__axis_1_1period__list_1a0d13682c45c552a06fb07e5a21d63e0f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a0d13682c45c552a06fb07e5a21d63e0f" kindref="member">convert</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>TA&amp;<sp/>ta<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref><sp/>r;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.reserve(<sp/>ta.size()<sp/>);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>ta.size();<sp/>++i<sp/>)</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.push_back(<sp/>ta.period(<sp/>i<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="419" refid="structshyft_1_1time__axis_1_1period__list_1a00cc861b69564b8d1e1229f9f72875d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a00cc861b69564b8d1e1229f9f72875d7" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.size();}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421" refid="structshyft_1_1time__axis_1_1period__list_1a3668cca757ecbfb56caea55676fd2157" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a3668cca757ecbfb56caea55676fd2157" kindref="member">total_period</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p.size()<sp/>==<sp/>0<sp/>?</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref>,<sp/><ref refid="namespaceshyft_1_1core_1a7ab17c4539f140317bac5575f94d58b4" kindref="member">min_utctime</ref><sp/>)<sp/>:<sp/><sp/></highlight><highlight class="comment">//<sp/>maybe<sp/>just<sp/>a<sp/>non-valid<sp/>period?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref>(<sp/>p.front().start,<sp/>p.back().end<sp/>);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight></codeline>
<codeline lineno="427" refid="structshyft_1_1time__axis_1_1period__list_1aa402f989f50b11fdd93f3627b9f1403e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1aa402f989f50b11fdd93f3627b9f1403e" kindref="member">time</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>p.size()<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p[i].start;</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;period_list.time(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432" refid="structshyft_1_1time__axis_1_1period__list_1a9821e7e4746dec86cc668a134058afe7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a9821e7e4746dec86cc668a134058afe7" kindref="member">period</ref>(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>&lt;<sp/>p.size()<sp/>)<sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/>p[i];;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::out_of_range(<sp/></highlight><highlight class="stringliteral">&quot;period_list.period(i)&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437" refid="structshyft_1_1time__axis_1_1period__list_1af63bb8072bf4ca22a53ada15cd9be1c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1af63bb8072bf4ca22a53ada15cd9be1c9" kindref="member">index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ix_hint<sp/>=<sp/>std::string::npos,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>period_containment<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal"><sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p.size()<sp/>==<sp/>0<sp/>||<sp/>tx<sp/>&lt;<sp/>p.front().start<sp/>||<sp/>tx<sp/>&gt;=<sp/>p.back().end<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::string::npos;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ix_hint<sp/>!=<sp/>string::npos<sp/>&amp;&amp;<sp/>ix_hint<sp/>&lt;<sp/>p.size()<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(<sp/>period_containment<sp/>&amp;&amp;<sp/>p[ix_hint].contains(<sp/>tx<sp/>)<sp/>)<sp/>||</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<sp/>!period_containment<sp/>&amp;&amp;<sp/>(<sp/>p[ix_hint].start<sp/>&gt;=<sp/>tx<sp/>&amp;&amp;<sp/>(<sp/>ix_hint<sp/>+<sp/>1<sp/>&lt;<sp/>p.size()<sp/>?<sp/>tx<sp/>&lt;<sp/>p[ix_hint<sp/>+<sp/>1].start<sp/>:<sp/>true<sp/>)<sp/>)<sp/>)<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>max_directional_search<sp/>=<sp/>10;<sp/></highlight><highlight class="comment">//<sp/>just<sp/><sp/>a<sp/>wild<sp/>guess</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p[ix_hint].end<sp/>&lt;<sp/>tx<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>p[ix_hint].end<sp/>&lt;<sp/>tx<sp/>&amp;&amp;<sp/>++j<sp/>&lt;<sp/>max_directional_search<sp/>&amp;&amp;<sp/>ix_hint<sp/>&lt;<sp/>p.size()<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix_hint++;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ix_hint<sp/>==<sp/>p.size()<sp/>)</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string::npos;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p[ix_hint].contains(<sp/>tx<sp/>)<sp/>)<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ok<sp/>this<sp/>is<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!period_containment<sp/>&amp;&amp;<sp/>ix_hint<sp/>+<sp/>1<sp/>&lt;<sp/>p.size()<sp/>&amp;&amp;<sp/>tx<sp/>&gt;=<sp/>p[ix_hint].start<sp/>&amp;&amp;<sp/>tx<sp/>&lt;<sp/>p[ix_hint<sp/>+<sp/>1].start<sp/>)</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight><highlight class="comment">//<sp/>this<sp/>is<sp/>the<sp/>closest<sp/>period<sp/>&lt;=<sp/>to<sp/>tx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>give<sp/>up<sp/>and<sp/>fall<sp/>through<sp/>to<sp/>binary-search</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>p[ix_hint].start<sp/>&gt;<sp/>tx<sp/>&amp;&amp;<sp/>++j<sp/>&lt;<sp/>max_directional_search<sp/>&amp;&amp;<sp/>ix_hint<sp/>&gt;<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--ix_hint;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p[ix_hint].contains(<sp/>tx<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!period_containment<sp/>&amp;&amp;<sp/>ix_hint<sp/>+<sp/>1<sp/>&lt;<sp/>p.size()<sp/>&amp;&amp;<sp/>tx<sp/>&gt;=<sp/>p[ix_hint].start<sp/>&amp;&amp;<sp/>tx<sp/>&lt;<sp/>p[ix_hint<sp/>+<sp/>1].start<sp/>)</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix_hint;</highlight><highlight class="comment">//<sp/>this<sp/>is<sp/>the<sp/>closest<sp/>period<sp/>&lt;=<sp/>to<sp/>tx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>give<sp/>up,<sp/>binary<sp/>search.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>r<sp/>=<sp/>lower_bound(<sp/>p.cbegin(),<sp/>p.cend(),<sp/>tx,</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[](<sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pt,<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>val<sp/>)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pt.start<sp/>&lt;=<sp/>val;<sp/>}<sp/>);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ix<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">size_t</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<sp/>r<sp/>-<sp/>p.cbegin()<sp/>)<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ix<sp/>==<sp/>string::npos<sp/>||<sp/>p[ix].contains(<sp/>tx<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix;<sp/></highlight><highlight class="comment">//cover<sp/>most<sp/>cases,<sp/>including<sp/>period<sp/>containment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!period_containment<sp/>&amp;&amp;<sp/>tx<sp/>&gt;=<sp/>p[ix].start<sp/>)</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ix;</highlight><highlight class="comment">//<sp/>ok<sp/>this<sp/>is<sp/>the<sp/>closest<sp/>period<sp/>that<sp/>matches</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string::npos;</highlight><highlight class="comment">//<sp/>no<sp/>match<sp/>to<sp/>period,what<sp/>so<sp/>ever</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="479" refid="structshyft_1_1time__axis_1_1period__list_1aba173b3f0de1bc46d066809fdbc1f1d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1aba173b3f0de1bc46d066809fdbc1f1d1" kindref="member">open_range_index_of</ref>(<sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tx<sp/>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>size()<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>tx<sp/>&gt;=<sp/>total_period().end<sp/>?<sp/>size()<sp/>-<sp/>1<sp/>:<sp/>index_of(<sp/>tx,<sp/>string::npos,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483" refid="structshyft_1_1time__axis_1_1period__list_1a9793a5a71630f86e57854fb05bea861f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a9793a5a71630f86e57854fb05bea861f" kindref="member">null_range</ref>()<sp/>{</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref>();</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight></codeline>
<codeline lineno="489" refid="namespaceshyft_1_1time__axis_1aec71c1b0f362be4c335177d0f6c033f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1aec71c1b0f362be4c335177d0f6c033f3" kindref="member">combine</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>&amp;<sp/>a,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>&amp;<sp/>b<sp/>)<sp/><sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>0.<sp/>check<sp/>if<sp/>they<sp/>overlap<sp/>(todo:<sp/>this<sp/>could<sp/>hide<sp/>dt-errors<sp/>checked<sp/>for<sp/>later)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pa<sp/>=<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5be8dd4e8ba1bd488a64350e94682b99" kindref="member">total_period</ref>();</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pb<sp/>=<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5be8dd4e8ba1bd488a64350e94682b99" kindref="member">total_period</ref>();</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6694f83c2a98cdbcefa520b555f25ecf" kindref="member">overlaps</ref>(<sp/>pb<sp/>)<sp/>||<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a61dc811a635c77b3c06ad262aefb9d52" kindref="member">size</ref>()<sp/>==<sp/>0<sp/>||<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a61dc811a635c77b3c06ad262aefb9d52" kindref="member">size</ref>()<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt_1ac4fc01ee49df2734371212df1fb5d7ca" kindref="member">fixed_dt::null_range</ref>();</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>==<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a6f1cb94f567f87b65c07413441a76ef0" kindref="member">t</ref><sp/>==<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a6f1cb94f567f87b65c07413441a76ef0" kindref="member">t</ref><sp/>&amp;&amp;<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5d6811761e7f9c06f8bb5e8ce0bd7924" kindref="member">n</ref><sp/>==<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1a5d6811761e7f9c06f8bb5e8ce0bd7924" kindref="member">n</ref><sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>a;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1ac53ac01de119a07afeaf67d32cd151e7" kindref="member">max</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>);</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>(<sp/>t0,<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref>,<sp/>(<sp/><ref refid="namespaceshyft_1_1timeseries_1a4fa091ae89d99e00daff8f0821576893" kindref="member">min</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref><sp/>)<sp/>-<sp/>t0<sp/>)<sp/>/<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>);</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>&gt;<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>%<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>)<sp/>!=<sp/>0<sp/>)<sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::runtime_error(<sp/></highlight><highlight class="stringliteral">&quot;combine(fixed_dt<sp/>a,b)<sp/>needs<sp/>dt<sp/>to<sp/>align&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1ac53ac01de119a07afeaf67d32cd151e7" kindref="member">max</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>);</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>(<sp/>t0,<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref>,<sp/>(<sp/><ref refid="namespaceshyft_1_1timeseries_1a4fa091ae89d99e00daff8f0821576893" kindref="member">min</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref><sp/>)<sp/>-<sp/>t0<sp/>)<sp/>/<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(<sp/>b.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>%<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>)<sp/>!=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::runtime_error(<sp/></highlight><highlight class="stringliteral">&quot;combine(fixed_dt<sp/>a,b)<sp/>needs<sp/>dt<sp/>to<sp/>align&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1ac53ac01de119a07afeaf67d32cd151e7" kindref="member">max</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>);</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>(<sp/>t0,<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref>,<sp/>(<sp/><ref refid="namespaceshyft_1_1timeseries_1a4fa091ae89d99e00daff8f0821576893" kindref="member">min</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref><sp/>)<sp/>-<sp/>t0<sp/>)<sp/>/<sp/>a.<ref refid="structshyft_1_1time__axis_1_1fixed__dt_1afdefdb74d677876c89401672f893b4ac" kindref="member">dt</ref><sp/>);</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>TA,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>TB&gt;</highlight></codeline>
<codeline lineno="516" refid="namespaceshyft_1_1time__axis_1a576642c2af630ea295df346733d2b12c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1aec71c1b0f362be4c335177d0f6c033f3" kindref="member">combine</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>TA&amp;<sp/>a,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>TB<sp/>&amp;<sp/>b,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>enable_if<sp/>&lt;<sp/>TA::continuous::value<sp/>&amp;&amp;<sp/>TB::continuous::value<sp/>&gt;::type*<sp/>x<sp/>=<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pa<sp/>=<sp/>a.total_period();</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pb<sp/>=<sp/>b.total_period();</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6694f83c2a98cdbcefa520b555f25ecf" kindref="member">overlaps</ref>(<sp/>pb<sp/>)<sp/>||<sp/>a.size()<sp/>==<sp/>0<sp/>||<sp/>b.size()<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>(<sp/><ref refid="structshyft_1_1time__axis_1_1point__dt_1a87dcf53e93aba68d4adc4739c944c94e" kindref="member">point_dt::null_range</ref>()<sp/>);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pa<sp/>==<sp/>pb<sp/>&amp;&amp;<sp/>a.size()<sp/>==<sp/>b.size()<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//possibly<sp/>exact<sp/>equal<sp/>?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>all_equal<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>a.size();<sp/>++i<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>a.period(<sp/>i<sp/>)<sp/>!=<sp/>b.period(<sp/>i<sp/>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>all_equal<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>all_equal<sp/>)</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>(<sp/>a<sp/>);</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>hard<sp/>way<sp/>merge<sp/>points<sp/>in<sp/>the<sp/>intersection<sp/>of<sp/>periods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1ac53ac01de119a07afeaf67d32cd151e7" kindref="member">std::max</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>te<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1a4fa091ae89d99e00daff8f0821576893" kindref="member">std::min</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref><sp/>);</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ia<sp/>=<sp/>a.open_range_index_of(<sp/>t0<sp/>);</highlight><highlight class="comment">//<sp/>first<sp/>possible<sp/>candidate<sp/>from<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ib<sp/>=<sp/>b.open_range_index_of(<sp/>t0<sp/>);</highlight><highlight class="comment">//<sp/>first<sp/>possible<sp/>candidate<sp/>from<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ea<sp/>=<sp/>1<sp/>+<sp/>a.open_range_index_of(<sp/>te<sp/>);</highlight><highlight class="comment">//<sp/>one<sp/>past<sp/>last<sp/>possible<sp/>candidate<sp/>from<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>eb<sp/>=<sp/>1<sp/>+<sp/>b.open_range_index_of(<sp/>te<sp/>);</highlight><highlight class="comment">//<sp/>one<sp/>past<sp/>last<sp/>possible<sp/>candidate<sp/>from<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1point__dt" kindref="compound">point_dt</ref><sp/>r;</highlight><highlight class="comment">//<sp/>result<sp/>generic<sp/>type<sp/>for<sp/>dense<sp/>time-axis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.reserve(<sp/>(<sp/>ea<sp/>-<sp/>ia<sp/>)<sp/>+<sp/>(<sp/>eb<sp/>-<sp/>ib<sp/>)<sp/>);<sp/><sp/></highlight><highlight class="comment">//assume<sp/>worst<sp/>case<sp/>here,<sp/>avoid<sp/>realloc</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1ab72d26e05117a10ed2f6fe5946e295dc" kindref="member">t_end</ref><sp/>=<sp/>te;</highlight><highlight class="comment">//<sp/>last<sp/>point<sp/>set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>ia<sp/>&lt;<sp/>ea<sp/>&amp;&amp;<sp/>ib<sp/>&lt;<sp/>eb<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>ta<sp/>=<sp/>a.time(<sp/>ia<sp/>);</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>tb<sp/>=<sp/>b.time(<sp/>ib<sp/>);</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ta<sp/>==<sp/>tb<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.push_back(<sp/>ta<sp/>);<sp/>++ia;<sp/>++ib;<sp/><sp/></highlight><highlight class="comment">//<sp/>common<sp/>point,push&amp;incr.<sp/>both</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ta<sp/>&lt;<sp/>tb<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.push_back(<sp/>ta<sp/>);<sp/>++ia;<sp/><sp/></highlight><highlight class="comment">//<sp/>a<sp/>contribution<sp/>only,<sp/>incr.<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.push_back(<sp/>tb<sp/>);<sp/>++ib;<sp/><sp/></highlight><highlight class="comment">//<sp/>b<sp/>contribution<sp/>only,<sp/>incr.<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>a<sp/>or<sp/>b<sp/>(or<sp/>both)<sp/>are<sp/>empty<sp/>for<sp/>time-points,<sp/>we<sp/>need<sp/>to<sp/>fill<sp/>up<sp/>remaining<sp/>&lt;<sp/>te</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ia<sp/>&lt;<sp/>ea<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>more<sp/>to<sp/>fill<sp/>in<sp/>from<sp/>a<sp/>?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>ia<sp/>&lt;<sp/>ea<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t_i<sp/>=<sp/>a.time(<sp/>ia++<sp/>);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t_i<sp/>&lt;<sp/>te<sp/>)<sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.push_back(<sp/>t_i<sp/>);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>more<sp/>to<sp/>fill<sp/>in<sp/>from<sp/>b<sp/>?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>ib<sp/>&lt;<sp/>eb<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t_i<sp/>=<sp/>b.time(<sp/>ib++<sp/>);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>t_i<sp/>&lt;<sp/>te<sp/>)<sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.push_back(<sp/>t_i<sp/>);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.back()<sp/>==<sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1ab72d26e05117a10ed2f6fe5946e295dc" kindref="member">t_end</ref><sp/>)<sp/><sp/></highlight><highlight class="comment">//<sp/>make<sp/>sure<sp/>we<sp/>leave<sp/>t_end<sp/>as<sp/>the<sp/>last<sp/>point.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1point__dt_1a7ad8a6d9c708ca4faab533ad5b3861f2" kindref="member">t</ref>.pop_back();</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref>(<sp/>r<sp/>);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="571"><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>TA,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>TB&gt;</highlight></codeline>
<codeline lineno="578" refid="namespaceshyft_1_1time__axis_1a11d76961aa5fbad3435004ea2f91efe1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref><sp/><ref refid="namespaceshyft_1_1time__axis_1aec71c1b0f362be4c335177d0f6c033f3" kindref="member">combine</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>TA&amp;<sp/>a,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>TB<sp/>&amp;<sp/>b,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>enable_if<sp/>&lt;<sp/>!TA::continuous::value<sp/>||<sp/>!TB::continuous::value<sp/>&gt;::type*<sp/>x<sp/>=<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pa<sp/>=<sp/>a.total_period();</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>pb<sp/>=<sp/>b.total_period();</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6694f83c2a98cdbcefa520b555f25ecf" kindref="member">overlaps</ref>(<sp/>pb<sp/>)<sp/>||<sp/>a.size()<sp/>==<sp/>0<sp/>||<sp/>b.size()<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a9793a5a71630f86e57854fb05bea861f" kindref="member">period_list::null_range</ref>();</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pa<sp/>==<sp/>pb<sp/>&amp;&amp;<sp/>a.size()<sp/>==<sp/>b.size()<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//possibly<sp/>exact<sp/>equal<sp/>?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>all_equal<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>a.size();<sp/>++i<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>a.period(<sp/>i<sp/>)<sp/>!=<sp/>b.period(<sp/>i<sp/>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>all_equal<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>all_equal<sp/>)</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list_1a0d13682c45c552a06fb07e5a21d63e0f" kindref="member">period_list::convert</ref>(<sp/>a<sp/>);</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="593"><highlight class="normal"></highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>hard<sp/>way<sp/>merge<sp/>points<sp/>in<sp/>the<sp/>intersection<sp/>of<sp/>periods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>t0<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1ac53ac01de119a07afeaf67d32cd151e7" kindref="member">std::max</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>);</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceshyft_1_1core_1abbf72b8ba32c19e92f5263070c1e9d13" kindref="member">utctime</ref><sp/>te<sp/>=<sp/><ref refid="namespaceshyft_1_1timeseries_1a4fa091ae89d99e00daff8f0821576893" kindref="member">std::min</ref>(<sp/>pa.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref>,<sp/>pb.<ref refid="structshyft_1_1core_1_1utcperiod_1a6633ffd83e46f9ef26098ffd4a2d61b7" kindref="member">end</ref><sp/>);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>tp(<sp/>t0,<sp/>te<sp/>);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ia<sp/>=<sp/>a.open_range_index_of(<sp/>t0<sp/>);<sp/><sp/></highlight><highlight class="comment">//notice<sp/>these<sp/>have<sp/>to<sp/>be<sp/>non-nan!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ib<sp/>=<sp/>b.open_range_index_of(<sp/>t0<sp/>);</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ia<sp/>==<sp/>string::npos<sp/>||<sp/>ib<sp/>==<sp/>string::npos<sp/>)</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>runtime_error(<sp/></highlight><highlight class="stringliteral">&quot;period_list::combine<sp/>algorithmic<sp/>error<sp/>npos<sp/>not<sp/>expected<sp/>here&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ea<sp/>=<sp/>1<sp/>+<sp/>a.open_range_index_of(<sp/>te<sp/>);</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>eb<sp/>=<sp/>1<sp/>+<sp/>b.open_range_index_of(<sp/>te<sp/>);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref><sp/>r;</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.reserve(<sp/>(<sp/>ea<sp/>-<sp/>ia<sp/>)<sp/>+<sp/>(<sp/>eb<sp/>-<sp/>ib<sp/>)<sp/>);<sp/><sp/></highlight><highlight class="comment">//assume<sp/>worst<sp/>case<sp/>here,<sp/>avoid<sp/>realloc</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>ia<sp/>&lt;<sp/>ea<sp/>&amp;&amp;<sp/>ib<sp/>&lt;<sp/>eb<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>while<sp/>both<sp/>do<sp/>have<sp/>contributions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>p_ia<sp/>=<sp/><ref refid="namespaceshyft_1_1core_1a012eb12624d0ee33c5b88721e4c23136" kindref="member">intersection</ref>(<sp/>a.period(<sp/>ia<sp/>),<sp/>tp<sp/>);</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>p_ib<sp/>=<sp/><ref refid="namespaceshyft_1_1core_1a012eb12624d0ee33c5b88721e4c23136" kindref="member">intersection</ref>(<sp/>b.period(<sp/>ib<sp/>),<sp/>tp<sp/>);</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ia.<ref refid="structshyft_1_1core_1_1utcperiod_1a657dbfcddcc6ea03d1db9c2248320bdb" kindref="member">timespan</ref>()<sp/>==<sp/>0<sp/>)<sp/>{++ia;<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;}<sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>contribution<sp/>from<sp/>a,<sp/>skip<sp/>to<sp/>next<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ib.timespan()<sp/>==<sp/>0<sp/>)<sp/>{++ib;<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;}<sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>contribution<sp/>from<sp/>b,<sp/>skip<sp/>to<sp/>next<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structshyft_1_1core_1_1utcperiod" kindref="compound">utcperiod</ref><sp/>p_i<sp/>=<sp/><ref refid="namespaceshyft_1_1core_1a012eb12624d0ee33c5b88721e4c23136" kindref="member">intersection</ref>(<sp/>p_ia,<sp/>p_ib<sp/>);<sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>intersection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_i.<ref refid="structshyft_1_1core_1_1utcperiod_1a657dbfcddcc6ea03d1db9c2248320bdb" kindref="member">timespan</ref>()<sp/>==<sp/>0<sp/>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>overlap|intersection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ia.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>&lt;<sp/>p_ib.start<sp/>)<sp/>++ia;<sp/><sp/></highlight><highlight class="comment">//advance<sp/>the<sp/>left-most<sp/>interval</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ib.start<sp/>&lt;<sp/>p_ia.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>)<sp/>++ib;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{++ia;<sp/>++ib;}<sp/></highlight><highlight class="comment">//TODO:<sp/>should<sp/>not<sp/>be<sp/>possible<sp/>?<sp/>since<sp/>it&apos;s<sp/>not<sp/>overlapping<sp/>start<sp/>cant<sp/>be<sp/>equal(except<sp/>one<sp/>is<sp/>empty<sp/>period)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="619"><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ia<sp/>==<sp/>p_ib<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.push_back(<sp/>p_ia<sp/>);<sp/>++ia;<sp/>++ib;<sp/><sp/></highlight><highlight class="comment">//<sp/>common<sp/>period,<sp/>push&amp;incr.<sp/>both</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ib.contains(<sp/>p_ia<sp/>)<sp/>)<sp/><sp/>{</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.push_back(<sp/>p_ia<sp/>);<sp/>++ia;<sp/><sp/></highlight><highlight class="comment">//<sp/>a<sp/>contribution<sp/>only,<sp/>incr.<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ia.<ref refid="structshyft_1_1core_1_1utcperiod_1a9389e69f1aa343d037ccafda9a2d11aa" kindref="member">contains</ref>(<sp/>p_ib<sp/>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.push_back(<sp/>p_ib<sp/>);<sp/>++ib;<sp/><sp/></highlight><highlight class="comment">//<sp/>b<sp/>contribution<sp/>only,<sp/>incr.<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//ok,<sp/>not<sp/>equal,<sp/>and<sp/>neither<sp/>a<sp/>or<sp/>b<sp/>contains<sp/>the<sp/>other</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ia.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>&lt;<sp/>p_ib.start<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.push_back(<sp/>p_i<sp/>);<sp/>++ia;<sp/><sp/></highlight><highlight class="comment">//<sp/>a<sp/>contribution<sp/>only,<sp/>incr.<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_ib.start<sp/>&lt;<sp/>p_ia.<ref refid="structshyft_1_1core_1_1utcperiod_1a84dc6f45bb83d9fdbf457bcd89db34e5" kindref="member">start</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r.<ref refid="structshyft_1_1time__axis_1_1period__list_1ae5aa972a826ec6db1b7d1d30fb078eb6" kindref="member">p</ref>.push_back(<sp/>p_i<sp/>);<sp/>++ib;<sp/><sp/></highlight><highlight class="comment">//<sp/>b<sp/>contribution<sp/>only,<sp/>incr.<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="636"><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T_A,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T_B,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>C<sp/>=<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>&gt;</highlight></codeline>
<codeline lineno="644" refid="structshyft_1_1time__axis_1_1combine__type" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1combine__type" kindref="compound">combine_type</ref><sp/>{<sp/></highlight><highlight class="comment">//<sp/>generic<sp/>fallback<sp/>to<sp/>period_list<sp/>type,<sp/>very<sp/>general,<sp/>but<sp/>expensive</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="645" refid="structshyft_1_1time__axis_1_1combine__type_1a7c353fe75e62eae439461a7180bcd97e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1period__list" kindref="compound">period_list</ref><sp/><ref refid="structshyft_1_1time__axis_1_1combine__type_1a7c353fe75e62eae439461a7180bcd97e" kindref="member">type</ref>;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;&gt;</highlight></codeline>
<codeline lineno="650" refid="structshyft_1_1time__axis_1_1combine__type_3_01fixed__dt_00_01fixed__dt_00_01void_01_4_1a9a30fc6aa147a3989e3d91aa1976d959" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1combine__type" kindref="compound">combine_type</ref>&lt;<ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>,<sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref>,<sp/>void&gt;<sp/>{</highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1fixed__dt" kindref="compound">fixed_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1combine__type_3_01fixed__dt_00_01fixed__dt_00_01void_01_4_1a9a30fc6aa147a3989e3d91aa1976d959" kindref="member">type</ref>;};</highlight></codeline>
<codeline lineno="651"><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T_A,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T_B&gt;<sp/></highlight><highlight class="comment">//<sp/>then<sp/>take<sp/>care<sp/>of<sp/>all<sp/>the<sp/>continuous<sp/>type<sp/>of<sp/>time-axis,<sp/>they<sp/>all<sp/>goes<sp/>into<sp/>generic_dt<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="654" refid="structshyft_1_1time__axis_1_1combine__type_3_01_t___a_00_01_t___b_00_01typename_01enable__if_3_086a4fbcb431e554b079aed359898683b_1af9db4e499d7d5bd2ba11ce71c8ab0c37" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structshyft_1_1time__axis_1_1combine__type" kindref="compound">combine_type</ref><sp/>&lt;<sp/>T_A,<sp/>T_B,<sp/>typename<sp/>enable_if<sp/>&lt;<sp/>T_A::<ref refid="structshyft_1_1time__axis_1_1continuous_1aeced14fe4486961b16feba5282e38a16" kindref="member">continuous::value</ref><sp/>&amp;&amp;<sp/>T_B::continuous::value<sp/>&gt;<ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">::type</ref><sp/>&gt;<sp/>{</highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="structshyft_1_1time__axis_1_1generic__dt" kindref="compound">generic_dt</ref><sp/><ref refid="structshyft_1_1time__axis_1_1combine__type_3_01_t___a_00_01_t___b_00_01typename_01enable__if_3_086a4fbcb431e554b079aed359898683b_1af9db4e499d7d5bd2ba11ce71c8ab0c37" kindref="member">type</ref>;};</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="656"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/Data/johnbur/Dropbox/home/Programming/workspace/shyft_cmake/shyft/core/time_axis.h"/>
  </compounddef>
</doxygen>
